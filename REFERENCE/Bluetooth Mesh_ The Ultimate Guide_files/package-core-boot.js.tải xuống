sndefine("core-sleeknote",(function(){return{}})),sndefine("constants",[],(function(){return{CORE:{EVENTS:{EXIT:"exit",ENTRY:"entry",LOAD:"load",SUBMIT:"submit",SITEDATA:"sitedata",READY:"ready",STORAGE:"storage",VISIBLE:"visible",PRODUCTREC:"productrec",ANIMATING:"animating",CLICK:"click"},CREATOR:{USER:"user",API:"api",QUEUE:"queue"},COMMANDS:{SUBMIT:"submitted",CLICK:"click",CURRENT:"current",OPEN:"open",QUEUE:"queue",CLOSE:"close",REVEAL:"reveal",MAXIMIZE:"maximize",MINIMIZE:"minimize"},API:{BUSY:"busy",ADD:"add",CLOSE:"close",CLOSEALL:"closeall",STATUS:"status",CAMPAIGNS:"campaigns",OPEN:"open",REVEAL:"reveal",QUEUE:"push",MAXIMIZE:"maximize",MINIMIZE:"minimize",REMOVE:"remove",NOTE_RERENDER:"rerender",NOTE_CONFIG:"config",APPLY_CONFIG:"apply",AFTERRENDER:"onafterrender",VISIBLE:"visible",WAIT:"wait",POSITION:"position",MERGE:"merge",HOOK:"hook",LAUNCH:"launch",EVALUATE:"evaluate",PROFILE:"profile",ORCHESTRATOR:"orchestrator"},LOGLEVELS:{CS:"1",CORE:"a",TRACKER:"t",EDITORTARGETING:"targeting"},FORMATTERS:{CONFIG:"config",EVALUATOR:"evaluator",CORE:"core",SNDEBUG:"sndebug"}},ELEMENTTYPES:["text","image","input","input-number","phone","checkbox","button","textarea","radio","linkbutton","spacer","sticker","close","select","container","group-sms","group-question","counter","clerk","customcatalogrec","raptor","helloretail","relewise","gmerch","shopifyfeed","video","spintowin","date","code","couponcode"],MIMIR:{EVENTS:{PAGERELOAD:"1_pagereload",PAGEVIEW:"2_pageview",SHOWN:"3_sleeknote_shown",ENGAGED:"4_sleeknote_engaged",CLOSED:"5_sleeknote_closed",LINK_CLICKED:"6_sleeknote_link_clicked",GOAL_CONVERTED:"7_goal_converted",TEASER_CLOSED:"8_sleeknote_teaser_closed",SUBSTEP_ENGAGED:"11_sleeknote_substep_engaged"},TRIGGERS:{TIMER:"1_sleeknote_trigger_shown_after",SCROLL:"2_sleeknote_trigger_scroll",EXIT:"3_sleeknote_exit_intent",MANUAL:"4_sleeknote_trigger_manual",TEASERCLICK:"5_sleeknote_teaser_clicked",MOUSESUBMIT:"6_sleeknote_submitbutton_clicked",KEYPRESSSUBMIT:"7_sleeknote_submitbutton_enterpress",CLOSEBUTTON:"8_sleeknote_closebutton_clicked",DISMISS:"9_sleeknote_dismissed",TEASERCLOSE:"10_sleeknote_teaser_closebutton_clicked",LINKBUTTON:"12_sleeknote_linkbutton_clicked",CLICK:"13_sleeknote_trigger_click",SITEDATA:"14_sleeknote_trigger_sitedata",EMBEDDED:"15_embedded_campaign_show"},NOTES:{NEWSLETTER:"1_Newsletter",PROMOTE:"2_Promote",CONTACT:"3_Contact",BLANK:"2_Promote"}},IMAGEMAXSIZE:25e4,PROFILE:{UNKN:1,IGNORE:2,DESKTOP:3,TABLET:4,MOBILE:5},PROFILEIDS:{DESKTOP:"desktop",MOBILE:"mobile"},POS:{POPUP:5,BOTTOM_LEFT:7,BOTTOM_RIGHT:9,CENTER_LEFT:4,CENTER_RIGHT:6,SLIDEUP:10,SLIDEUP2:11,HELLO:12,HELLO2:17,POPUP2:13,POPUP7:15,POPUP9:16,POPUP5:18,EMBEDDED:20,SIDEBAR_LEFT:21,SIDEBAR_RIGHT:22},AL:{TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4},PA:{CENTER:1,INSIDE:2,OUTSIDE:3,RIGHT:4,LEFT:5,BOTTOM:6,TOP:7},TARGETING:{VISIBILITY:{SHOW:"include",HIDE:"exclude"},TYPES:{MATCHES:"exactMatch",CONTAINS:"contains"},RELATIONS:{AND:"AND",OR:"OR"}},TRIGGERS:{TYPES:{1:"Show After",2:"Scroll",3:"Exit-Intent",4:"Manual",5:"Click",6:"Automated",7:"SiteData"}},CONDITIONS:{PAGESVISITEDOPTIONS:{ONESESSION:"current session",ALLSESSIONS:"all sessions"},UTMSOURCE:"utm_source",UTMMEDIUM:"utm_medium",UTMCAMPAIGN:"utm_campaign",UTMTERM:"utm_term",UTMCONTENT:"utm_content",GROUPS:{AND:!0,OR:!1},KEYS:{SEQUENCE:"sequence",SUBSCRIBER:"currentSubscriber",VISITOR:"newVisitor",QUERY:"specificQuery",REFERRAL:"specificReferral",UTM:"utm",SHOW:"showCount",COOKIE:"specificCookie",GEOTARGETING:"geotargeting",ELEMENT:"htmlElement",SITE:"siteData",PAGE:"pageCount",TARGETING:"specificURL",NOTARGETING:"targetAll",IP:"specificIP",URLMATCHES:"URLMatches",URLCONTAINS:"URLContains"},TYPES:{EXISTS:"exists",NOTEXISTS:"notExists",EXACTMATCH:"exactMatch",NOTEXACTMATCH:"notExactMatch",CONTAINS:"contains",LESSTHAN:"lessThan",LESSTHANEQ:"lessThanEq",GREATERTHAN:"greaterThan",GREATERTHANEQ:"greaterThanEq",EQUALS:"equals"},MATCHTYPES:{INCLUDE:"include",EXCLUDE:"exclude",NONE:"none",BOTH:"both"}},SUNDAY:0,MONDAY:1,DATETIMEFORMAT:"DD-MM-YYYY - HH:mm",DATETIMEFORMATDAYJS:"D-M-YYYY - HH:mm",DATEFORMAT:"DD-MM-YYYY",DATEFORMATDAYJS:"D-M-YYYY",ISODATEFORMAT:"YYYY-MM-DD",TIMEFORMAT:"- HH:mm",SCHEDULERDATEFORMAT:"YYYY/MM/DD",SCHEDULERDATEFORMATDAYJS:"YYYY/M/D",SETUPDATEFORMAT:"Do MMMM YYYY",URLPATTERN:"^((?:https?:\\/\\/)?[^./]+(?:\\.[^./]+)+(?:\\/.*)?)$",IPPATTERN:"^((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(,\\n|,?|,\\s))*$",SHOPIFYURLPATTERN:"^.*products.json$",INPUTNAMEALLOWEDPATTERN:"^[a-zA-Z][\\w:.\\-]*$",MYCAMPAIGNSURL:"../dashboard/",YOUTUBEURLVALIDATION:"(http(?:s?):\\/\\/)?(?:www\\.)?youtu(?:be\\.com\\/(?:watch\\?v=|shorts\\/)|\\.be\\/)([\\w\\-_]*)(&(amp;)?[\\w\\?=]*)?",CLEANURLREGEX:"(^\\w+://(www.)?|(www.))",TIMESPANS:{last7Days:"last7Days",last30Days:"last30Days",last3Months:"last3Months",last6Months:"last6Months",customRange:"customRange"}}})),function(){var e,t=this,n=t.document,s=["Webkit","ms","Moz"],r=n.createElement("div");function i(e){var t,n=e.charAt(0).toUpperCase()+e.slice(1);if(e in r.style)return"";for(t=s.length;t--;)if(s[t]+n in r.style)return s[t];return!1}var o=i("transform"),a={};function l(e,t){t||(t=o),a[t]||(a[t]={});var n=a[t][e];return void 0===n&&(n=a[t][e]=t.length?t+e.charAt(0).toUpperCase()+e.substr(1):e[0].toLowerCase()+e.substr(1)),n}var c={standalone:t.navigator.standalone,retina:t.devicePixelRatio>=1.5},u=t.navigator.userAgent.toLowerCase();c.bot=/bingpreview|bingbot|adidxbot|adsbot-google|googlebot|mediapartners-google|googleweblight|google page speed insights|headlesschrome/gi.test(u);var d,g,m,p=(g=u.match(/(edge|edg)[\s\/:]([\w\d\.]+)/),"unknown"==(m=u.match(/(opera|ie|firefox|chrome|trident|crios|version)[\s\/:]([\w\d\.]+)?.*?(safari|(?:rv[\s\/:]|version[\s\/:])([\w\d\.]+)|$)/)||[null,"unknown",0])[1]&&g&&(m=g),"trident"==m[1]?(m[1]="ie",m[4]&&(m[2]=m[4])):"crios"==m[1]&&(m[1]="chrome"),(d=/iemobile|windows phone/i.test(t.navigator.appVersion)?"winphone":u.match(/ip(?:ad|od|hone)/)?"ios":(u.match(/(?:webos|android)/)||u.match(/mac|win|linux|cros/)||["other"])[0])&&"other"!=d||(d=t.navigator.platform,/mac/i.test(d)&&(d="mac"),/win/i.test(d)&&(d="windows")),"win"==d&&(d="windows"),{name:"version"==m[1]?m[3]:m[1],version:parseFloat("opera"==m[1]&&m[4]?m[4]:m[2]),platform:d});if("unknown"!=p.name&&(c[p.name]=!0),c.version=p.version,c.name=p.name,c.platform=p.platform,/edg/.test(c.name)&&(c.name="edge"),"edge"==c.name&&c.version>50&&(c.name="chrome",c[c.name]=!0),"ie"==p.name&&n.documentMode&&(c.version=n.documentMode),"BackCompat"==n.compatMode&&(c.quirks=!0,c.version=1),c[p.platform]=!0,c.windows=c.windows||c.winphone,c.mozilla=c.firefox,c.webkit=c.safari||c.chrome,c.webkit&&"webkitAnimation"in r.style&&(o="Webkit"),c.desktop=!(c.android||c.ios||c.winphone),c.android)c.tablet=!/mobile/i.test(u),c.tablet&&(c.desktop=!1),c.genuineAndroid=!/intel/i.test(t.navigator.platform);else{var h=!1;if("iPad"==t.navigator.platform&&(h=!0),!h&&"iPhone"!=t.navigator.platform)!(h=-1!==u.indexOf("ipad"))&&u.match(/mac/)&&t.navigator.maxTouchPoints&&t.navigator.maxTouchPoints>2&&(h=!0);h&&(c.ios=!0,c.mac=!1,c.platform="ios",c.desktop=!1),c.ios&&(c.tablet=h,r.style.setProperty("-apple-pay-button-style","black"),c.genuineApple="black"==r.style.getPropertyValue("-apple-pay-button-style"))}c.phone=!c.desktop&&!c.tablet,c.device=c.tablet?"tablet":c.phone?"phone":"desktop";var f,y={orientationchange:"onorientationchange"in t,threeD:l("perspective")in n.documentElement.style,touch:"ontouchstart"in t||t.navigator.msMaxTouchPoints>0,transform:!1!==o,animation:!1!==i("animationName"),pointer:!!t.PointerEvent,pointerGestures:!!t.MSGesture,pointerEvents:(f=r.style,"pointerEvents"in f&&(f.pointerEvents="auto",f.pointerEvents="foo","auto"==f.pointerEvents))};c.ie&&c.version<=10&&(y.pointerEvents=!1);var E,S,v="onorientationchange"in t?"orientationchange":"resize",I={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend"};for(e in I)if(void 0!==r.style[e]){E=I[e];break}var C={animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend"};for(e in C)if(void 0!==r.style[e]){S=C[e];break}var w=o.length?"-"+o.toLowerCase()+"-":"";var T={language:function(){return t.navigator.language||t.navigator.userLanguage},timezoneOffSet:function(){return(new Date).getTimezoneOffset()}};function O(){return t.innerHeight||(n.documentElement||n.body).clientHeight||0}function b(){return t.innerWidth||(n.documentElement||n.body).clientWidth||0}function A(){return 90==(b()<O()?0:90)}function N(e,s,r,i){r||(r=n.body),i||(i=n.documentElement);var o=t.getComputedStyle(i),a=t.getComputedStyle(r),l=Math.max(r.offsetHeight,i.offsetHeight,r.clientHeight,i.clientHeight),c=Math.max(r.offsetWidth,i.offsetWidth,r.clientWidth,i.clientWidth);return"hidden"==o.overflowY||"hidden"==a.overflowY||s||(l=Math.max(l,r.scrollHeight,i.scrollHeight)),"hidden"==o.overflowX||"hidden"==a.overflowX||e||(c=Math.max(c,r.scrollWidth,i.scrollWidth)),{width:c,height:l}}function P(){return t.pageYOffset||(n.documentElement||n.body.parentNode||n.body).scrollTop||0}var R,k={top:P,pct:function(){var e=N().height-O();return 0===e?100:Math.floor(P()/e*100)}},D={screen:{width:function(){return Math[A()?"max":"min"](t.screen.width,t.screen.height)},height:function(){return Math[A()?"min":"max"](t.screen.width,t.screen.height)},availWidth:function(){return Math[A()?"max":"min"](t.screen.availWidth,t.screen.availHeight)},availHeight:function(){return Math[A()?"min":"max"](t.screen.availWidth,t.screen.availHeight)}},content:{width:0,height:0},win:{width:b,height:O},doc:{dims:N,width:function(e,t,n){return N(e,!0,t,n).width},height:function(e,t,n){return N(!0,e,t,n).height}}};var M=n.querySelector("meta[name=viewport], meta[id=viewport]");function L(e,t){if(e&&"fixed"==t)return"fixed"==e||~e.indexOf("sticky")}function x(){return D.doc.width(!c.desktop,n.body,n.documentElement)}function U(e){var t=x();return c.phone&&void 0!==e&&(Array.isArray(e)?t=Number(e[A()?1:0]):Number(e)===e&&e>0&&(t=e)),t/D.win.width()}function B(e,t,n){return n||(n=.1),Math.abs(e-t)<=n}var V={screenWidth:D.screen.width,screenHeight:D.screen.height,windowWidth:b,windowHeight:O,minimalScreenDimension:function(){return Math.min(D.screen.width(),D.screen.height())},isAddressBarVisible:function(){return!!(c.phone&&c.ios&&c.safari)&&(!!A()&&!B(x()/D.screen.width()*D.screen.availHeight(),D.win.height(),1))},getDocumentScale:U,getDocumentWidth:x,notScaledMobileContent:function(){return B(D.screen.width(),D.win.width()*U(),1)},isPositionValue:L,getPositionValue:function(e){return L(e,"fixed")?c.desktop&&c.safari?"-webkit-sticky":"fixed":e},systemScrollbarWidth:function(){var e;return void 0!==R||(R=0,y.touch||(n.body.insertAdjacentHTML("beforeend",'<div style="visibility:hidden;overflow-y:scroll;">blaah</div>'),e=n.body.lastElementChild,R=e.offsetWidth-e.clientWidth,e.parentNode.removeChild(e))),R},is:c,has:y,jsVendor:o,otherVendors:function(){var e,t=[];for(e=s.length;e--;)s[e]!=o&&t.push(s[e]);return o.length&&t.push(""),t},cssVendor:w,prefixStyle:l,transitionEnd:E,animationEnd:S,resizeEvent:v,mouseButton:function(e){var t="right",n="middle";if(void 0!==e.buttons&&0!==e.buttons){if(2==e.buttons)return t;if(4==e.buttons)return n}else{if(2==e.button)return t;if(1==e.button)return n;if(c.mac&&17==function(e){return 16==e.which||17==e.which||18==e.which||91==e.which?e.which:(e.ctrlKey?17:e.shiftKey&&16)||e.altKey&&18||e.metaKey&&91||0}(e))return t}return c.mac&&e.ctrlKey?t:"left"},isLandscape:A,scroll:k,user:T,userAgent:function(){return t.navigator.userAgent}};sndefine("browser",(function(){if(D.content.width=D.screen.width(),D.content.height=D.screen.height(),!c.desktop&&M&&M.content){var e=M.content.split(",").filter((function(e){if(~e.indexOf("width"))return 1}))[0];e&&(e=parseInt(e.split("=")[1],10)),e===Number(e)&&(D.content.width=e,D.content.height=D.screen.height()/(D.screen.width()/e))}return V}))}.call(this),sndefine("global",(function(){let e=this.document.getElementById("sleeknote-frame");function t(){return e&&e.contentWindow||this}const n=["fetch","FormData","setInterval","setTimeout","clearInterval","clearTimeout"];return new(t().Proxy)({},{get(e,s){let r=t()[s];return n.includes(s)&&(r=r.bind(t())),r}})})),function(){var e={decode:function(e){for(var t,n,s=[],r=0,i=e.length;r<i;){if(55296==(63488&(t=e.charCodeAt(r++)))){if(n=e.charCodeAt(r++),55296!=(64512&t)||56320!=(64512&n))throw new RangeError("UTF-16(decode): Illegal UTF-16 sequence");t=((1023&t)<<10)+(1023&n)+65536}s.push(t)}return s},encode:function(e){for(var t,n=[],s=0,r=e.length;s<r;){if(55296==(63488&(t=e[s++])))throw new RangeError("UTF-16(encode): Illegal UTF-16 value");t>65535&&(t-=65536,n.push(String.fromCharCode(t>>>10&1023|55296)),t=56320|1023&t),n.push(String.fromCharCode(t))}return n.join("")}},t=128,n=72,s="-",r=36,i=700,o=1,a=26,l=38,c=2147483647;function u(e,t){return e+22+75*(e<26)-((0!==t)<<5)}function d(e,t,n){var s;for(e=n?Math.floor(e/i):e>>1,e+=Math.floor(e/t),s=0;e>(r-o)*a>>1;s+=r)e=Math.floor(e/(r-o));return Math.floor(s+(r-o+1)*e/(e+l))}function g(i,l){var u,g,m,p,h,f,y,E,S,v,I,C,w,T,O=[],b=[],A=i.length;for(u=t,m=0,p=n,(h=i.lastIndexOf(s))<0&&(h=0),f=0;f<h;++f){if(l&&(b[O.length]=i.charCodeAt(f)-65<26),i.charCodeAt(f)>=128)throw new RangeError("Illegal input >= 0x80");O.push(i.charCodeAt(f))}for(y=h>0?h+1:0;y<A;){for(E=m,S=1,v=r;;v+=r){if(y>=A)throw RangeError("punycode_bad_input(1)");if((I=(T=i.charCodeAt(y++))-48<10?T-22:T-65<26?T-65:T-97<26?T-97:r)>=r)throw RangeError("punycode_bad_input(2)");if(I>Math.floor((c-m)/S))throw RangeError("punycode_overflow(1)");if(m+=I*S,I<(C=v<=p?o:v>=p+a?a:v-p))break;if(S>Math.floor(c/(r-C)))throw RangeError("punycode_overflow(2)");S*=r-C}if(p=d(m-E,g=O.length+1,0===E),Math.floor(m/g)>c-u)throw RangeError("punycode_overflow(3)");u+=Math.floor(m/g),m%=g,l&&b.splice(m,0,i.charCodeAt(y-1)-65<26),O.splice(m,0,u),m++}if(l)for(m=0,w=O.length;m<w;m++)b[m]&&(O[m]=String.fromCharCode(O[m]).toUpperCase().charCodeAt(0));return e.encode(O)}function m(i,l){var g,m,p,h,f,y,E,S,v,I,C,w;l&&(w=e.decode(i));var T=(i=e.decode(i.toLowerCase())).length;if(l)for(y=0;y<T;y++)w[y]=i[y]!=w[y];var O,b,A=[];for(g=t,m=0,f=n,y=0;y<T;++y)i[y]<128&&A.push(String.fromCharCode(w?(O=i[y],b=w[y],(O-=(O-97<26)<<5)+((!b&&O-65<26)<<5)):i[y]));for(p=h=A.length,h>0&&A.push(s);p<T;){for(E=c,y=0;y<T;++y)(C=i[y])>=g&&C<E&&(E=C);if(E-g>Math.floor((c-m)/(p+1)))throw RangeError("punycode_overflow (1)");for(m+=(E-g)*(p+1),g=E,y=0;y<T;++y){if((C=i[y])<g&&++m>c)return Error("punycode_overflow(2)");if(C==g){for(S=m,v=r;!(S<(I=v<=f?o:v>=f+a?a:v-f));v+=r)A.push(String.fromCharCode(u(I+(S-I)%(r-I),0))),S=Math.floor((S-I)/(r-I));A.push(String.fromCharCode(u(S,l&&w[y]?1:0))),f=d(m,p+1,p==h),m=0,++p}}++m,++g}return A.join("")}var p={encodePuny:function(e){for(var t=e.split("."),n=[],s=0;s<t.length;++s){var r=t[s];n.push(r.match(/[^A-Za-z0-9-]/)?"xn--"+m(r):r)}return n.join(".")},decodePuny:function(e){for(var t=e.split("."),n=[],s=0;s<t.length;++s){var r=t[s];n.push(r.match(/^xn--/)?g(r.slice(4)):r)}return n.join(".")}};sndefine("punycode",(function(){return p}))}.call(this),sndefine("utils",["global"],(function(e){var t,n=this,s=n.document,r={};function i(){return e}if(n.location&&!n.location.origin&&(n.location.origin=n.location.protocol+"//"+n.location.hostname+(n.location.port?":"+n.location.port:"")),s.head||(s.head=s.getElementsByTagName("head")[0]),this.document.body){["querySelectorAll","querySelector","getElementsByClassName","getElementsByTagName"].forEach((function(e){r[e]=function(t,n){try{return function(e,t){if(e)switch(e.nodeType){case 0:return function(){};case 1:return i().Element.prototype[t];case 9:return i().Document.prototype[t];case 11:return i().DocumentFragment.prototype[t]||function(){};default:return console.warn("unknown node type: "+e.nodeType),console.trace(),function(){}}}(t,e).call(t,n)}catch(e){}}}))}t=function(e,t,n,s){return e===e+""&&(e=r.getElementById(e)),function r(i){return e[t+"EventListener"](i,n,!!s),r}},r.JSON={parse:function(){return i().JSON.parse.apply(n,arguments)},stringify:function(){return i().JSON.stringify.apply(n,arguments)}};var o={};function a(e,t){if(e){if(Array.isArray(e)||"function"==typeof e[t])return e;if("item"in e&&"length"in e)return Array.from(e)}}let l=i().Array.prototype.entries;function c(e){let t=a(e,"keys");return t?t.keys():Object.keys(e||o)}function u(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function d(){var e,t,n,s,r,i=arguments.length;for(1==i?("array"==(t=u(arguments[0]))&&(s=[]),"object"==t&&(s={}),r=0):(s=arguments[0],r=1);r<i;r++)if("array"!=(t=u(n=arguments[r]))&&"object"!=t)s=n;else for(e in n)t=u(n[e]),s[e]="array"==t||"object"==t?d(s[e]?s[e]:"array"==t?[]:{},n[e]):n[e];return s}function g(e){return e?e.nodeName?e:s.getElementById(e):null}function m(e,t){return t&&!t.nodeName?(console.warn("QSA second argument must be Element",t),[]):Array.prototype.slice.call(r.querySelectorAll(t||s,e))}["XMLHttpRequest","decodeURIComponent","encodeURIComponent"].forEach((function(e){r[e]=function(){return i()[e].apply(n,arguments)}}),this),["getElementById","createElement","createDocumentFragment"].forEach((function(e){r[e]=function(){return i().document[e].apply(s,arguments)}}),this),r.getComputedStyle=function(e,t){return i().getComputedStyle.call(n,e,t)};var p,h=s.documentElement,f=(p=h.matches||h.matchesSelector||h.webkitMatchesSelector||h.msMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector)?function(e,t){return p.call(e,t)}:function(e,t){for(var n=e.parentNode?r.querySelectorAll(e.parentNode,t):[],s=n.length;s--;)if(n[s]===e)return!0};function y(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function E(e){return e.replace(/^-ms-/,"ms-").replace(/-([a-z])/g,(function(e,t){return t.toUpperCase()}))}function S(e,t,n){return Array.prototype.slice.call(e,t,n)}function v(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")}function I(e){switch(e.nodeName.toLowerCase()){case"input":switch(e.type){case"checkbox":case"radio":if(e.checked)return e.value;break;case"file":case"reset":break;default:return e.value}break;case"textarea":return e.value;case"select":switch(e.type){case"select-one":return e.value;case"select-multiple":var t,n=0;for(n=0,t=e.options.length;n<t;n++)if(e.options[n].selected)return e.options[n].value}break;default:return e.innerText}}let C=i().Promise;var w=C.allSettled?e=>C.allSettled(e):e=>C.all(e.map((e=>e.then((e=>({status:"fulfilled",value:e}))).catch((e=>({status:"rejected",reason:e}))))));function T(e,t,n){var s=e;if("string"==u(t)){for(var r=t.split(n||"."),i=0;i<r.length&&void 0!==(s=s[r[i]]);i++);return s}}return d(r,{redirectTwemojiUrl:function(e){if("string"==u(e)&&e.includes("/twemoji.maxcdn.com/")){let t=e.split("/").pop().split(".").shift();e=`https://sleeknotestaticcontent.sleeknote.com/emoji/${t}.svg`}return e},definePropConst:function(e,t){let n=Object.keys(t)[0];return Object.defineProperty(e,n,{value:t[n]})},getDocument:function(e){if(e)return"contentDocument"in e?e.contentDocument:e.contentWindow.document},deepProp:T,allSettled:w,Promise:i().Promise,URL:i().URL,findPropValue:function e(t,n){if(String(n).split(".").length>1)return T(t,n);var s=u(t);if("array"==s||"object"==s)for(var r in t)if("array"==(s=u(t[r]))){if(r==n)return t[r];if(void 0!==(i=e(t[r],n)))return i}else if("object"==s){var i;if(void 0!==(i=e(t[r],n)))return i}else if(r==n&&void 0!==t[r])return t[r]},normalizeFontFamily:function(e){return String(e).split(",")[0].toLowerCase().replace(/['"]+/g,"").replace(/^\s+|\s+$/g,"")},urlFromCSSUrl:function(e){return e&&(e=(e=String(e)).slice(e.indexOf("(")+1,e.indexOf(")")).replace(/"/g,"")).includes(".")?e:""},urlencode:v,entries:function(e){let t=a(e,"entries");return t?l.call(t):Object.entries(e||o)},keys:c,values:function(e){let t=a(e,"values");return t?t.values():Object.values(e||o)},DOMContentLoaded:function(){return new(0,i().Promise)((function e(t){"loading"!=s.readyState?t():i().setTimeout(e,100,t)}))},expireDaysToDate:function(e){var t=new Date;if(e=+e||0)return t.setTime(t.getTime()+864e5*e),t},randomName:function(){var e;do{e=Math.random().toString(36).substring(7)}while(!e.substr(0,1).match(/[a-zA-Z]/));return e},appendToUrl:function(e,t){return e+(t?(~e.indexOf("?")?"&":"?")+t:"")},parseForm:function(e,t,n){"use strict";var s,r,i,o,a={};function l(e,t,n){a[e]=t}if(!e||!e.nodeName||"form"!==e.nodeName.toLowerCase())throw"You must supply a form element";for(s=0,r=e.elements.length;s<r;s++)""===(i=e.elements[s]).name||i.disabled||void 0!==(o=I(i))&&l(i.name,o);Object.keys(t||{}).forEach((function(e){l(e,t[e])}));var c=[];return n?c=a:(c=[],Object.keys(a).forEach((function(e){c.push(v(e)+"="+v(a[e]))}))),c},parseNodeValue:I,keyValueToQueryString:function(e){"use strict";var t=[];return c(e).forEach((function(n){t.push(v(n)+"="+v(e[n]))})),t.join("&")},click:function(e,t){return function(e,t,n){var r;if(e)try{(r=s.createEvent("MouseEvent")).initMouseEvent(n||t.type,!0,!0,t.view,0,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),r.initialTarget=t.target,e.dispatchEvent(r)||r.preventDefault()}catch(e){console.log(e.message)}}(e,t,"click")},getAdvOption:function(e,t,n){for(var s=e.options||[],r=s.length,i=[];r--;)if(s[r].id==t){i=s[r].values||[];break}if(void 0===n)return i;for(r=i.length;r--;)if(i[r].id==n)return i[r].value},typeStr:u,listener:t,gid:g,qsa:m,qs:function(e,t){return m(e,t)[0]},extend:d,contains:function(e){var t=Array.isArray(arguments[1])?arguments[1]:S(arguments,1);return Array.isArray(e)?t.some((function(t){return~e.indexOf(t)})):"object"==u(e)?t.some((function(t){return t in e})):t.some((function(t){return e==t}))},slice:S,removeNode:function(e){e&&(e.nodeName||(e=g(e)),e&&e.parentNode&&e.parentNode.removeChild(e))},eventXY:function(e,t){var n,r;return t||(t=0),e.changedTouches&&e.changedTouches.length>t?(n=e.changedTouches[t].pageX,r=e.changedTouches[t].pageY):e.targetTouches&&e.targetTouches.length>t?(n=e.targetTouches[t].pageX,r=e.targetTouches[t].pageY):e.pageX||e.pageY?(n=e.pageX,r=e.pageY):(e.clientX||e.clientY)&&(n=e.clientX+s.body.scrollLeft+s.documentElement.scrollLeft,r=e.clientY+s.body.scrollTop+s.documentElement.scrollTop),{x:n,y:r}},throttle:function(e,t,s,r,o){function a(){this.lastTime=0,this.timer=0,this.after=this.after.bind(this),this.run=this.run.bind(this),this.a1,this.a2,this.a3}s||(s=n),a.prototype={after:function(){t.call(s,this.a1,this.a2,this.a3,3),this.lastTime=0,this.timer=0},run:function(){var n=+new Date,a=r&&!this.lastTime?1:n-this.lastTime>e?2:0;a&&(o||(t.call(s,this.a1,this.a2,this.a3,a),this.lastTime=n),this.timer&&i().clearTimeout(this.timer),this.timer=i().setTimeout(this.after,1.25*e))},throttle:function(e,t,n){this.a1=e,this.a2=t,this.a3=n,i().setTimeout(this.run,0)}};var l=new a;return l.throttle.bind(l)},applyOptions:function(e){var t,n=Object.prototype.hasOwnProperty;if(e)for(t in e)n.call(e,t)&&(this[t]=e[t])},template:function(e,t){for(var n=Array.isArray(t)?t.map((function(e,t){return t})):Object.keys(t),s=n.length;s--;)e=e.replace(new RegExp("\\{"+n[s]+"\\}","g"),t[n[s]]);return e.replace(/\{\w*\}/g,"")},insertHTML:function(e,t,n){return e&&e.nodeName?(n||(n="beforeend"),"afterbegin"==n?s=e.firstElementChild:"afterend"==n&&(s=e.nextElementSibling),e.insertAdjacentHTML(n,Array.isArray(t)?t.join(""):t),"beforebegin"==n?e.previousElementSibling:"afterbegin"==n?s?s.previousElementSibling:e.lastElementChild:"beforeend"==n?e.lastElementChild:"afterend"==n?s?s.previousElementSibling:e.parentNode.lastElementChild:void 0):null;var s},isNumeric:function(e){return!/^(NaN|-?Infinity)$/.test(+e)},isFunction:function(e){return"function"==u(e)},getHostname:function(e){return function e(t){return void 0===e.link&&(e.link=r.createElement.call(s,"a")),e.link.href=2==t.split("://").length?t:n.location.protocol+"//"+t,String(e.link.host)}(e)},getHashParams:function(e){var t,n=0,s={};if((e=([(e=e+""||(e=r.getElementsByTagName("script"))&&e.item(e.length-1).src).split("#")[1]]+"").split("&"))[0])for(;n<e.length;n++)s[(t=e[n].split("=",2))[0]]=t[1]?r.decodeURIComponent(t[1].replace(/\+/g," ")):void 0;return s},empty:function(e){var t=Object.prototype.hasOwnProperty;if(!e||0===e.length)return!0;var n=u(e);if("array"!=n){if("object"==n){for(var s in e)if(t.call(e,s))return!1;return!0}return!(e+"").match(/\S/)}},matchesSel:f,guid:function(e){var t=e||{prefix:!1,length:8};t.prefix||(t.prefix=!1),t.length||(t.length=8),this.length=t.length,this.timestamp=+new Date;for(var n,s,r=this.timestamp.toString().split("").reverse(),i="",o=0;o<this.length;++o){i+=r[(n=0,s=r.length-1,Math.floor(Math.random()*(s-n+1))+n)]}return t.prefix&&(i=t.prefix+"-"+i),i},guid_string:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},querySelectorClosest:function(e,t){if(e)do{if(f(e,t))break}while(e=e.parentElement);return e},getQueryVarByName:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(n.location.search||n.location.hash);return t?r.decodeURIComponent(t[1].replace(/\+/g," ")):""},cleanUpReferral:function(e){var t=e,n=(t=(t=(t=(t=t.replace("https://","")).replace("http://","")).replace("www.","")).split("/")[0]).split(".");return t=t.replace("."+n[n.length-1],"")},trim:function(e){return e?(e+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):""},camelCaseToDashSeparated:y,dashSeparatedToCamelCase:E,PascalCaseToDashSeparated:function(e){return y(e).substr(1)},getAppliedStyles:function(e,t={}){const{asCSSVars:n}=t;let s=e.style,r=s.length,i=Object.create(null);for(;r--;){let e=E(s[r]);if(n){i[`--${E(e)}`]=s[e]}else i[e]=s[e]}return i}}),r})),sndefine("location",["utils","punycode"],(function(e,t){var n=this,s=n.document.createElement("a");function r(){var e=Array.isArray(arguments[0])?arguments[0]:arguments;this.set.apply(this,e)}function i(t,n){var s,r,i={};if((t=(t=t.replace(/[?#]/,"")).split("&").filter((function(t){return!e.empty(t)})))[0])for(s=0;s<t.length;s++){r=t[s].split("=",2);try{i[r[0]]=r[1]?n?r[1]:e.decodeURIComponent(r[1].replace(/\+/g," ")):void 0}catch(e){e instanceof URIError&&(console.log("Error decoding query, using encoded one"),i[r[0]]=r[1])}}return i}function o(e,t){return s.href=a(e,t),new r(t,s.hostname,s.pathname,s.search,s.hash,s.port).toString()}function a(e,t){return t||(t="http:"),/^\/\//i.test(e)||(t+="//"),/^https?:\/\//i.test(e)||(e=t+e),e}function l(e,t){s.href=e;var n,i=s.pathname.replace(".aspx","").replace(".html","").replace(".htm","").replace(".php",""),o=r.prototype.queryParams.call(s,!0),a=!s.search&&s.hash,l=[];for(n in o)if(o.hasOwnProperty(n)){if(!(n.indexOf("utm_")&&n.toLowerCase().indexOf("sndebug")&&n.toLowerCase().indexOf("snbranch")&&n.toLowerCase().indexOf("snreset")&&n.toLowerCase().indexOf("snsubscribed")))continue;l.push(n+(void 0===o[n]?"":":"+o[n]))}return l=l.join("&"),e=(e=(e=new r(s.protocol,s.hostname,i,a?"":l,a?l:t?"":s.hash,s.port)).toString().replace(/\/$/g,"")).replace(/:\/\/www\./g,"://")}function c(e,t){if(t&&(c.loc=void 0),!c.loc){var s=e.local===String(e.local)?r.fromString(e.local):n.location;c.loc=new r(["protocol","hostname","pathname","search","hash","port"].map((function(t){var r;return"pathname"==t&&"/"==s[t]?n.location[t]:(r=s[t]||n.location[t],"hostname"==t&&(r=r.replace(/^www\./,"")),"search"==t&&e.custom("ignoreHashInUrlPath")&&s.hash.indexOf("?")>-1&&(r=s.hash.slice(s.hash.indexOf("?"))),r)})))}return c.loc}return r.fromString=function(e){return s.href=t.decodePuny(e),new r(s.protocol,s.hostname,s.pathname,s.search,s.hash,s.port)},r.addProtocolIf=a,r.extractDomain=function(r){return"string"!=e.typeStr(r)||e.empty(r)?"":(r=t.decodePuny(r),s.href=l(o(r,n.location.protocol),!0),s.hostname)},r.prototype={domainMatches:function(e){return e=t.decodePuny(e),s.href=l(o(e,this.protocol),!0),this.hostname==s.hostname},matches:function(e,n){e=l(o(e=t.decodePuny(e),this.protocol),!n).toUpperCase();var s,r=l(this.toString(),!n).toUpperCase();if(~e.indexOf("*")){var i=e.split("*")[0];return s=l(i).toUpperCase(),"/"==i[i.length-1]&&i.split("/").length>4&&(s+="/"),0===r.indexOf(s)||0===(r+"/").indexOf(s)}return r==e},contains:function(e){return null!=e&&!1!==e&&l(this.toString(),!0).toUpperCase().indexOf(String(e).toUpperCase())>-1},queryParams:function(e){return i(!this.search&&this.hash?this.hash:this.search,e)},toString:function(){return this.href},set:function(e,t,n,s,r,i){e||(e="http:"),r=r?("#"==r.charAt(0)?"":"#")+r:"",s=s?("?"==s.charAt(0)?"":"?")+s:"",i||(i=""),n||(n=""),n&&"/"!=n.charAt(0)&&(n="/"+n),80!=i&&443!=i||(i="");var o=e+"//"+(t=(t||"").split(":")[0])+(i?":"+i:"");return this.hash=r,this.search=s,this.port=i||"",this.origin=o,this.protocol=e,this.href=o+n+s+r,this.hostname=t,this.pathname=n,this.host=t,this}},r.get=c,r.reset=function(e){return c(e,!0)},r})),sndefine("logger",["core-sleeknote","constants"],(function(e,t){const n=this;function s(...e){try{throw new Error("debug")}catch(n){var t=n.stack.split("\n").slice(2,3).join("").split(":").slice(2,3).join("");return e.push("line:",t),e.join(" ")}}function r(e,t,n){return"string"==typeof e&&(e=e.split("-")[0]),n===Boolean(n)&&(n=n?"YES":"NO"),0===(t+"").indexOf("START")&&(e="\n"+e),void 0!==n&&(t+=": "+n),e+" "+t}function i(e,t,n,s,r){e.CampaignId;var i=(e.CampaignId+"").split("-")[0];r===Boolean(r)&&(r=r?"YES":"NO");var o=[i," ",t||""," [",n||"",', "',s||"",'"]'];void 0!==r&&o.push(" ->");r=void 0===r?"":r;return o.join("")+r}return{log:function(o,a=(e=>e)){const l=t.CORE.FORMATTERS,c={[l.EVALUATOR]:i,[l.CORE]:s,[l.CONFIG]:r};if(e.debug==o){if(c[a])return a=c[a],(...e)=>{console.log(a(...e))};if(a==l.SNDEBUG)return(...e)=>function({type:e,msgs:t=[],styles:s=[]}){if(n.location.search.includes("sleeknote_logs_to_var"))return n.logs||(n.logs=""),n.logs+=t.join(""),void(n.logs+="\n");s=s.map((e=>{switch(e){case"error":return"font-weight: bold; color: rgb(221, 48, 82)";case"normal":return"color: rgb(37, 52, 90)";case"normal-bold":return"color: rgb(37, 52, 90);font-weight: bold;";case"success":return"font-weight: bold; color: rgb(11, 121, 93)";case"message":return"color: rgb(84, 87, 255);font-weight: bold;";case"group":return"font-weight: bold;color: rgb(38, 39, 115);";case"italic":return"font-style: italic;";default:return e}}));let r="";t.forEach((e=>{r+=`%c${e}`}));let i=[r,...s];switch(e){case"group":console.group(...i);break;case"groupCollapsed":console.groupCollapsed(...i);break;case"groupEnd":console.groupEnd();break;default:console.log(...i)}}(...e)}return o==t.CORE.LOGLEVELS.EDITORTARGETING?(n.targetingEditorLog="",e=>{n.targetingEditorLog+=`${e.msgs[0]}<br/>`}):()=>{}}}})),sndefine("consent",["utils","core-sleeknote"],(function(e,t){var n=this,s={},r={},i=0;const o="SleekNote";function a(t,n){return n==o?e.dashSeparatedToCamelCase("sleeknote-"+t+"-consent"):`${n}.consent.${t}`}function l(e,o,l,c){let u=o in s?o[s]:function(e){let{namespaces:s}=t;try{!s&&n.sndefine&&(s=n.sndefine.namespaces)}catch(e){}for(let t of s){let s=a(e,t);if(s in n)return r[e]=!!n[s]}}(o),d=a(o,e),g=Object.getOwnPropertyDescriptor(n,d);if(!g||!g.set){void 0===u?(u=l(o,!0),s[o]=void 0===u||!!u,i&&console.log("consent for "+o+" is read from cookie:",u)):(s[o]=u,c(s[o],o,l),i&&console.log("consent for "+o+" is defined preliminarly:",s[o]));const e=function(e){e=!!e,s[o]!=e&&(s[o]=e,c(s[o],o,l),i&&console.log("consent for "+o+" is set to:",s[o]))};Object.defineProperty(n,d,{set:e,get:function(){var t=new Boolean(!!s[o]);return t.set=e,t}})}}return{get:function(e){return i&&console.log("consent for "+e+" is:",s[e]),s[e]},initialize:function(e,s,r){let{namespaces:i}=t;try{!i&&n.sndefine&&(i=n.sndefine.namespaces)}catch(e){}for(let t of i)l(t,e,s,r);i.has(o)||l(o,e,s,r)}}})),sndefine("cookie",["utils"],(function(e){var t=this.document;return{hasItem(n){if(n)return new RegExp("(?:^|;\\s*)"+e.encodeURIComponent(n).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(t.cookie)},keys:()=>t.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/).map((t=>e.decodeURIComponent(t))),getItem(n,s){return n&&function(t,n){return n?t:e.decodeURIComponent(t)}(t.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+(r=n,i=s,i?r:e.encodeURIComponent(r)).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"),s)||null;var r,i},setItem(n,s,r,i,o,a,l){let c="";if(n&&!/^(?:expires|max\-age|path|domain|secure)$/i.test(n)){if(r)switch(r.constructor){case Number:c=r===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+r;break;case String:c="; expires="+r;break;case Date:c="; expires="+r.toUTCString()}return t.cookie=(l?n:e.encodeURIComponent(n))+"="+(l?s:e.encodeURIComponent(s))+c+(o?"; domain="+o:"")+(i?"; path="+i:"")+(a?"; secure":"")+"; SameSite=Lax",!0}},removeItem(n,s,r){return!!this.hasItem(n)&&(t.cookie=e.encodeURIComponent(n)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(r?"; domain="+r:"")+(s?"; path="+s:""),!0)}}})),sndefine("targeting-evaluator",["logger","constants","utils","global","location"],(function(e,t,n,s,r){const i=this,{MATCHES:o,CONTAINS:a}=t.TARGETING.TYPES,{SHOW:l,HIDE:c}=t.TARGETING.VISIBILITY,{AND:u}=t.TARGETING.RELATIONS,d=[o,a],g={AND:"every",OR:"some"};function m(e){try{const t=r.addProtocolIf(e,"https:");return new s.URL(t)}catch(e){console.error(e)}}return{[o](e,t,s,r){const o=r||i.location;function a(e){return"/"==e[e.length-1]?e.substring(0,e.length-1):e}function l(e){return"www."==e.substring(0,4)?e.substring(4,e.length):e}return n.keys(e).some((e=>{this.log({msgs:[`       ${e} ...`],styles:["normal"]});const t=m(e),n=["hostname","pathname","search","hash"].every((e=>{let n=o[e],s=t[e];if(("search"==e||"hash"==e)&&!s)return!0;if("hostname"==e&&(n=l(n),s=l(s)),"pathname"==e&&(s=a(s),n=a(n),s.includes("*"))){let[t,r]=s.split("*");const i=!t||n.substring(0,t.length).toUpperCase()==t.toUpperCase(),o=!r||n.substring(n.length-r.length,n.length).toUpperCase()==r.toUpperCase();return i&&o?this.log({msgs:[`            "${s}" matches current url ${e}(${n})`],styles:["normal"]}):this.log({msgs:[`            "${s}" doesn't match current url ${e}(${n})`],styles:["normal"]}),i&&o}if(s.includes("*")){let e=s.split("*")[0];s=s.substr(0,e.length),n=n.substr(0,e.length)}return s.toUpperCase()==n.toUpperCase()?(this.log({msgs:[`            "${s}" matches current url ${e}(${n})`],styles:["normal"]}),!0):(this.log({msgs:[`            "${s}" doesn't match current url ${e}(${n})`],styles:["normal"]}),!1)}));return n||this.log({msgs:[`            "${e}" doesn't match current url(${o.href})`],styles:["normal"]}),n}))},[a](e,t,s,r){const o=r||i.location,a=g[t];return n.keys(e)[a]((e=>{this.log({msgs:[`       ${e} ...`],styles:["normal"]});const t=["hostname","pathname","search","hash"].some((t=>!!o[t].toUpperCase().includes(e.toUpperCase())&&(this.log({msgs:[`            "${e}" found in ${t}`],styles:["normal"]}),!0)));return t||this.log({msgs:[`          "${e}" not found in this URL`],styles:["normal"]}),t}))},proccessTree(e,t,s){if(d.includes(e.type)){this.log({msgs:[`   ${e.type.toUpperCase()} ${e.relationOperator==u?"all of":"one of"}:`],styles:["normal"]});const n=this[e.type](e.values,e.relationOperator,t,s);return this.log({msgs:[`   ${e.type.toUpperCase()} with ${e.relationOperator} relation evaluated to: ${n}`],styles:["normal"]}),n}if(!n.empty(e.children)){"Root"!=e.id&&this.log({msgs:[` ${e.visibility==l?"SHOW":"HIDE"} if URL...`],styles:["normal"]});const r=g[e.relationOperator];let i=n.keys(e.children)[r]((n=>this.proccessTree(e.children[n],t,s)));return i=e.visibility==c?!i:i,"Root"!=e.id&&this.log({msgs:[` group ${e.visibility==l?"SHOW":"HIDE"} evaluated to ${i?"SHOW":"HIDE"}`],styles:["normal"]}),i}},evaluate:function(n){this.log=e.log(t.CORE.LOGLEVELS.CS,t.CORE.FORMATTERS.SNDEBUG);var s=(n.CampaignId+"").split("-")[0];return!!n.targeting.targetAll||this.proccessTree(n.targeting.root,s)},editorEvaluate:function(n,s){this.log=e.log(t.CORE.LOGLEVELS.EDITORTARGETING);const r=m(n),i=this.proccessTree(s.root,"",r);return this.log({msgs:["TARGETING EVALUATED TO "+(i?"SHOW":"HIDE")]}),i}}})),sndefine("event-emitter",["utils","global","core-sleeknote","constants"],(function(e,t,n,s){var r=this,i=r.document;let o=s.CORE.EVENTS,a=s.CORE.COMMANDS;function l(e){let t="sleekNote";return"SleekNote"!=e&&(t=e),t}function c(e){let t=l(e),n=i.createEvent("Event");return n.initEvent(t,!0,!0),n}function u(s,l){return new t.Promise((function(t,u){try{r.requestAnimationFrame((function(){var r=i.createEvent("Event");if(r.initEvent(n.eventName,!0,!0),r.data=function(t,s){switch(t){case o.LOAD:return{type:t,command:s.command,NS:s.NS,coreConfig:n};case o.READY:let r=s,i={},a={};for(let[t,n]of e.entries(r.notes))a[t]={name:t,DOMNode:n.config.DOMNode},i[t]=n.config.DOMNode;return{type:t,campaignId:r.config.campaignId,NS:r.config.NS,boxes:a,DOMNodes:i};default:if(!s)return{command:t,type:t};let l=s.origin&&s.origin.config||s.campaign&&s.campaign.config;return{...s,command:t,type:s.type||t,campaignId:l&&l.campaignId||s.campaignId,NS:s.NS||l&&l.NS}}}(s,l),r.detail=r.data,i.dispatchEvent(r),r.data.result&&r.data.result.then?r.data.result.then(t,u):t(),"visible"==s)["opened","closed"].map((function(t){for(let n of e.values(l[t])){let e=c(n.campaign.config.NS);e.data={type:"opened"==t?o.ENTRY:o.EXIT,campaignId:n.campaign.config.campaignId,box:{name:n.noteName},origin:n.campaign.notes[n.noteName],noteName:n.noteName,NS:n.campaign.config.NS},n.noteName&&(e.data.box.DOMNode=n.campaign.notes[n.noteName].config.DOMNode),i.dispatchEvent(e)}}));else if(r.data.NS){let e=c(r.data.NS);s==o.LOAD||s==o.READY||s==a.CLOSE?e.data=r.data:s==a.CLICK?e.data={type:o.CLICK,campaignId:l.campaignId,DOMNode:l.eventTarget,noteName:l.name,href:l.href,action:l.step}:s==a.SUBMIT&&(e.data={type:o.SUBMIT,campaignId:l.campaignId,data:l.formData}),e.data&&i.dispatchEvent(e)}}))}catch(e){u()}}))}return e.definePropConst(u,{createUserEventName:l}),u})),sndefine("storage-categories",["consent","utils","core-sleeknote"],(function(e,t,n){let s={timestamp:"sn_global_countdown_last_reset_timestamp",_sn_a:"_sn_a",_sn_m:"_sn_m",_sn_n:"_sn_n",location:"location",mergeId:"mergeId",cookie:"cookie",session:"session",siteData:"siteData",local:"local",analytics:"analytics",marketing:"marketing",SNSubscribed:"SNSubscribed",SNS:"SNS",necessary:"necessary",SleekNote:"SleekNote",oos:"oos"},{timestamp:r,_sn_a:i,_sn_m:o,_sn_n:a,location:l,cookie:c,session:u,siteData:d,local:g,analytics:m,marketing:p,SNSubscribed:h,SNS:f,necessary:y,SleekNote:E,mergeId:S,oos:v}=s,I={[m]:["visitorId","goalShown","goalEngaged","userSessionStart","userSessionEnd",l],[y]:["globalCountdown","sessionId","campaignClosed","campaignHidden","sessionConverted","campaignEngaged","queryIncluded","showCount","sessionShowCount","inSplitTest","splitTestCohort","consent","mergeId"],[p]:["referrer","UTMInclude","sequence","pagesVistedTotal","pageVisitedSession","newVisitor","geoLocation","IPAddress"]};let C={cookie:{[i]:{default:{},type:c},[o]:{default:{},type:c},[a]:{default:{},type:c},[f]:{type:c},[h]:{type:c}},local:{[E]:{default:{},type:g},[r]:{type:g}},session:{[E]:{default:{},type:u}}},w={[m]:I[m],[p]:I[p],[d]:[d]};return{isAllowed:function(s){if(n.preview)return!1;if(s==d)return e.get(s);for(let[n,r]of t.entries(w))if(r.includes(s))return e.get(n);return!0},overAllKeys:async function(e,n,s,r){for(let[i,o]of t.entries(C))for(let t of Object.keys(o)){let o=await e[i][n](t);s&&s.call(r,o,i,t)}},getStorage:function(e){let s=function(e){let s=n.custom("necessaryNotInCookie"),r=n.custom("marketingNotInCookie");if(t.contains(e,d))return u;let i=[v,S,"timestamp"];return s&&i.push("globalCountdown","sessionId","campaignClosed","campaignHidden","sessionConverted","campaignEngaged","queryIncluded","showCount","sessionShowCount","inSplitTest","splitTestCohort"),r&&i.push("referrer","UTMInclude","sequence","pagesVistedTotal","pageVisitedSession","newVisitor","geoLocation","IPAddress"),t.contains(e,i)?g:c}(e),i=e;return s==c?i=function(e){for(let[n,s]of t.entries(I))if(s.includes(e))return"_sn_"+n.charAt(0);return e}(e):s==u?i=E:s==g&&(i="timestamp"==i?r:E),{type:s,key:i}},props:s,storageKeys:C,getStorageForErase:function(e){return{[m]:[[c,i]],[p]:[[c,o]],[d]:[[u,E]]}[e].map((e=>({type:e[0],key:e[1]})))}}})),sndefine("storage-base",["utils","storage-categories"],(function(e,t){function n(t){for(let s in t)"object"==typeof t[s]?(n(t[s]),e.empty(t[s])&&delete t[s]):null!=t[s]&&""!==t[s]||delete t[s];return e.empty(t)?void 0:t}return class{constructor(e){this.cache=Object.create(null)}has(e){return e in this.cache}async write(s,r,i){this.cache[r]=e.extend(i),void 0===(i=n(this.cache[r]))?await this.erase(r):t.isAllowed(s)&&await this.writeData(r,i)}async writeData(e){}async read(n){let s=t.storageKeys[this.type][n].default,r=await this.readData(n);return this.cache[n]=e.extend(void 0===r?s:r),this.cache[n]}async readData(e){}async erase(e){let n=t.storageKeys[this.type][e].default;void 0===n?delete this.cache[e]:this.cache[e]=n,await this.eraseData(e)}async eraseData(e){}}})),sndefine("storage-cookie",["utils","cookie","storage-base","core-sleeknote"],(function(e,t,n,s){return class extends n{constructor(t){super(t),this.cookiePath=s.custom("cookiePath","/"),this.cookieDomain=void 0,this.cookieSecure=!1,this.days=365,this.noCookieEncoding=!0,this.type="cookie",e.applyOptions.call(this,t)}setCookie(n,s,r,i){return t.setItem(n,s,e.expireDaysToDate(r),this.cookiePath,this.cookieDomain,this.cookieSecure,i)}removeCookie(e){return t.removeItem(e,this.cookiePath,this.cookieDomain)}readCookie(e,n){return t.getItem(e,n)}async writeData(t,n){this.setCookie(t,e.JSON.stringify(n),this.days,this.noCookieEncoding)}async readData(n){let s;try{null!==t.getItem(n)&&(s=e.JSON.parse(t.getItem(n)))}catch(e){}return s}async eraseData(e){this.removeCookie(e)}}})),sndefine("storage-local",["utils","storage-base","global"],(function(e,t,n){var s=this;return class extends t{constructor(e){super(e),this.type=e.name||"local",this.name=this.type+"Storage",function(e){try{return s[e].setItem("test","1"),s[e].removeItem("test"),e in s&&null!==s[e]}catch(e){}}(this.name)||(this.dummyStorage=!0)}async readData(t){if(!this.dummyStorage){let n;try{n=e.JSON.parse(s[this.name].getItem(t))}catch(e){}return null===n?void 0:n}}async writeData(t,r){return!!this.dummyStorage||new n.Promise((n=>{s.requestAnimationFrame((()=>{s[this.name].setItem(t,e.JSON.stringify(r)),n()}))}))}async eraseData(e){this.dummyStorage||s[this.name].removeItem(e)}}})),sndefine("storage-cookie-session",["utils","storage-cookie"],(function(e,t){var n="SNS";return class extends t{constructor(){super(),this.set=!!this.readCookie(n,!0),this.set||this.setCookie(n,1,"",!0)}unset(){this.set=!1,this.removeCookie(n)}}})),sndefine("storage-instance",["utils","storage-cookie-session","constants","core-sleeknote","location","storage-cookie","storage-local","storage-categories","consent","event-emitter","global"],(function(e,t,n,s,r,i,o,a,l,c,u){var d=this.document;function g(e){return String(e).substring(0,4)}let m=new class{constructor(){this.providers={session:new o({name:"session"}),local:new o({name:"local"}),cookie:new i},d.addEventListener(s.eventName,this)}handleEvent(t){let r=n.CORE.COMMANDS,{command:i,campaignId:o,origin:a,name:l}=t.data;if(i==r.OPEN){let e=a.campaign;if(e.first("form")==l){if(this.incrementShowCount(o),e.config.position==n.POS.EMBEDDED)return;this.closeSession(o),n.PROFILE.MOBILE!=e.config.profile||e.isHello||this.hideSession(o)}}else if(i==r.CLOSE){if(a.campaign.config.position==n.POS.EMBEDDED)return;let t=a.config.type;e.contains(t,"teaser","form")&&this.hideSession(o)}else if(i==r.SUBMIT){let e,t,r=a.campaign,i=!0;switch(r.config.type){case"social":break;case"newsletter":e=!0,t=!0;break;case"contact":case"blank":case"promote":case"guide":t=!0}if(i&&this.setShowCount(o,999999),t&&this.setEngaged(o),r.config.position==n.POS.EMBEDDED&&!s.custom("embeddedSetSubscription"))return;if(e&&this.setSubscription(),r.config.position==n.POS.EMBEDDED)return;this.hideSession(o)}}async postCreate(){await a.overAllKeys(this.providers,"read");let i=a.props._sn_n,o=this.providers.cookie,u=this;function g(e,t){l.initialize(e,(function(e,n){let s=o.cache[i];return n?s[t]:s}),(function(e,n,s){let r=s(n);e?delete r[t]:(r[t]=e,u.erase(n)),o.write("consent",i,r)}))}g.bind(this,"analytics","ca").call(),g.bind(this,"marketing","cm").call(),g.bind(this,"siteData","csd").call(),this.resetMemData();let m=new t,p=this.isNotNewVisitor();m.set||(await this.resetSessionData(),this.setNewVisitor(p)),this.isNotNewVisitor()&&this.setNewVisitor(!1),this.newVisitor=this.getNewVisitor();let h=e.cleanUpReferral(d.referrer);!this.getReferral()&&h.indexOf(r.get(s).host)<0&&this.setReferral(h),s.isSubscribedFromQuery&&this.setSubscription(),c(n.CORE.EVENTS.STORAGE,{ready:"ready"}),this.postCreate=()=>{}}async clear(){await a.overAllKeys(this.providers,"erase"),await this.postCreate()}read(t){let{type:n,key:s}=a.getStorage(t),r={};return n&&s&&(r=this.providers[n].cache[s]),"object"!=e.typeStr(r)||"cs"in r||(r.cs={}),r}async write(e,t){let{type:n,key:s}=a.getStorage(e);if(n&&s){let r=t;return this.providers[n].write(e,s,r)}}async erase(e){for(let{type:t,key:n}of a.getStorageForErase(e).values())return"cookie"!==t&&n!=a.props.timestamp?this.write(e,void 0):this.providers[t].erase(n)}readByCampaignId(e,t){let n=this.read(e);return n.cs||(n.cs={}),n.cs[g(t)]||{}}async writeByCampaignId(t,n,s){let r=this.read(t);return r.cs||(r.cs={}),e.empty(s)?delete r.cs[g(n)]:r.cs[g(n)]=s,this.write(t,r)}preserveIfNotExpired(e){return e&&e.length>=1?Date.now()<e[0]?e:void 0:e}async resetSessionData(){this.deleteReferral(),this.deleteGoal(),this.deleteGeoInfo(),this.deleteSessionShowCount(),this.resetMemData(),await this.resetCampaignSessionData()}resetMemData(){this.pageVisited={}}async resetCampaignSessionData(){await a.overAllKeys(this.providers,"read",(async function(t,n,s){if(t&&t.cs)for(let[n,s]of e.entries(t.cs))t.cs[n]={i:this.preserveIfNotExpired(s.i),pv:s.pv}}),this)}async forceResetSession(e){var t,n,s;"full"!=e&&(t=this.getGeoInfo(),s=this.getIPAddress(),n=this.getPagesVisitedCount()),a.overAllKeys(this.providers,"erase"),this.setNewVisitor(this.isNotNewVisitor()),this.newVisitor=this.getNewVisitor(),t&&this.setGeoInfo(t),n&&this.setPagesVisitedCount(n),s&&this.setIPAddress(s),this.startSessionTime()}async closeSession(e){var t=this.readByCampaignId("campaignClosed",e);return t.c=1,this.writeByCampaignId("campaignClosed",e,t)}async openSession(e){var t=this.readByCampaignId("campaignClosed",e);return delete t.c,this.writeByCampaignId("campaignClosed",e,t)}isSessionClosed(e){return!!(this.readByCampaignId("campaignClosed",e)||{}).c}async hideSession(e){var t=this.readByCampaignId("campaignHidden",e);return t.h=1,this.writeByCampaignId("campaignHidden",e,t)}async unHideSession(e){var t=this.readByCampaignId("campaignHidden",e);return delete t.h,this.writeByCampaignId("campaignHidden",e,t)}isSessionHidden(e){return!!this.readByCampaignId("campaignHidden",e).h}migrateEngaged(e){var t=this.readByCampaignId("campaignEngaged",e);return t.e=1,this.writeByCampaignId("campaignEngaged",e,t)}setEngaged(e){var t=this.readByCampaignId("campaignEngaged",e);t.e=1,this.writeByCampaignId("campaignEngaged",e,t),this.recordGoalEngaged(e)}setUnEngaged(e){let t=this.readByCampaignId("campaignEngaged",e);delete t.e,this.writeByCampaignId("campaignEngaged",e,t),t=this.read("goalEngaged"),t.g&&t.g.e&&(delete t.g.e[e],this.write("goalEngaged",t))}isEngaged(e){return!!this.readByCampaignId("campaignEngaged",e).e}convertSessionEvent(e){var t=this.readByCampaignId("sessionConverted",e);return t.z=1,this.writeByCampaignId("sessionConverted",e,t)}hasConvertSessionEvent(e){return!!this.readByCampaignId("sessionConverted",e).z}setUTMInclude(e,t){var n=this.readByCampaignId("UTMInclude",e);return n.u=t,this.writeByCampaignId("UTMInclude",e,n)}getUTMInclude(e){return this.readByCampaignId("UTMInclude",e).u}setQueryInclude(e,t){var n=this.readByCampaignId("queryIncluded",e);return n.q=t,this.writeByCampaignId("queryIncluded",e,n)}getQueryInclude(e){return this.readByCampaignId("queryIncluded",e).q}getSequence(t){var n,s=this.readByCampaignId("sequence",t);return n=s.s,Array.isArray(n)&&n.forEach((function(t,n,s){s[n]=e.decodeURIComponent(t)})),n||[]}setSequence(t,n){var s,r=this.readByCampaignId("sequence",t);return e.empty(n)?delete r.s:r.s=(s=n,Array.isArray(s)&&s.forEach((function(t,n,s){s[n]=e.encodeURIComponent(t)})),s),this.writeByCampaignId("sequence",t,r)}getPagesVisitedCountPerSession(e){return this.readByCampaignId("pageVisitedSession",e).pvs}setPagesVisitedCountPerSession(t,n){var s=this.readByCampaignId("pageVisitedSession",t);return e.empty(n)?delete s.pvs:s.pvs=n,this.writeByCampaignId("pageVisitedSession",t,s)}getPagesVisitedCount(e){return(this.readByCampaignId("pagesVistedTotal",e)||{}).pv}setPagesVisitedCount(t,n){var s=this.readByCampaignId("pagesVistedTotal",t);return e.empty(n)?delete s.pv:s.pv=n,this.writeByCampaignId("pagesVistedTotal",t,s)}getPagesVisitedCountSetted(e){return this.pageVisited[e]&&this.pageVisited[e].spv}setPagesVisitedCountSetted(e,t){this.pageVisited[e]={spv:t}}getPagesVisitedCountPerSessionSetted(e){return this.pageVisited[e]&&this.pageVisited[e].spvs}setPagesVisitedCountPerSessionSetted(e,t){this.pageVisited[e]={spvs:t}}setSubscription(){return this.providers.cookie.write("sns","SNSubscribed",!0)}eraseSubscription(){return this.providers.cookie.write("sns","SNSubscribed",!1)}isSubscribed(){return this.providers.cookie.read("SNSubscribed",!1)}migrateShowCount(e,t,n){var s=this.readByCampaignId("showCount",e);s.i=[n,t],this.writeByCampaignId("showCount",e,s)}setShowCount(t,n,s){s=+s||365;var r=this.readByCampaignId("showCount",t);return r.i=[e.expireDaysToDate(s).getTime(),n],this.writeByCampaignId("showCount",t,r)}getShowCount(e){var t=this.readByCampaignId("showCount",e);return t.i=t.i||[],t.i[1]||0}incrementShowCount(e){this.setShowCount(e,this.getShowCount(e)+1),this.incrementSessionShowCount(),this.recordGoalShown(e)}eraseShowCount(e){var t=this.readByCampaignId("showCount",e);return delete t.i,this.writeByCampaignId("showCount",e,t)}cleanShowCount(e){this.getShowCount(e)<1&&this.eraseShowCount(e)}deleteSessionShowCount(){var e=this.read("sessionShowCount");return delete e.ssc,this.write("sessionShowCount",e)}setSessionShowCount(e){var t=this.read("sessionShowCount");return t.ssc=e,this.write("sessionShowCount",t)}getSessionShowCount(){return+this.read("sessionShowCount").ssc||0}incrementSessionShowCount(){return this.setSessionShowCount(this.getSessionShowCount()+1)}deleteReferral(e){var t=this.read("referrer");if(t.r)return delete t.r.r,this.write("referrer",t)}setReferral(e){var t=this.read("referrer");return t.r=t.r||{},t.r.r=e,this.write("referrer",t)}getReferral(){var e=this.read("referrer");return e.r=e.r||{},e.r.r||""}isNotNewVisitor(){return void 0===this.getNewVisitor()}setNewVisitor(e){var t=this.read("newVisitor");return t.r=t.r||{},t.r.n=+e,this.write("newVisitor",t)}getNewVisitor(){var e=this.read("newVisitor");return e.r=e.r||{},e.r.n}setVistorIdIf(e){var t=this.read("visitorId");if(t)return t.v=t.v?t.v:e,this.write("visitorId",t),t.v}getVistorId(){var t=this.read("visitorId");return t.v||(t.v=e.guid_string(),this.write("visitorId",t)),t.v}hasVisitorId(){return!e.empty(this.read("visitorId").v)}deleteGeoInfo(e){var t=this.read("geoLocation");return delete t.gi,this.write("geoLocation",t)}async setGeoInfo(e){var t=this.read("geoLocation");return t.gi=e,this.write("geoLocation",t)}getGeoInfo(){return this.read("geoLocation").gi}async fetchGeoInfo(){let t=this.getGeoInfo();if(e.empty(t)){if(t=await u.fetch("https://geolocation.sleeknote.com").then((e=>e.text())).then((e=>{let t=JSON.parse(e);if(t.countryCode)return{lt:t.latitude,lg:t.longitude,latitude:t.latitude,longitude:t.longitude,country:t.countryName,countryCode:t.countryCode,regionCode:t.regionCode,regionName:t.regionName}})).catch((e=>{console.log(e)})),e.empty(t))return!1;await this.setGeoInfo(t)}return t}setIPAddress(e){var t=this.read("IPAddress");return t.ip=e,this.write("IPAddress",t),t.ip}getIPAddress(){return this.read("IPAddress").ip}deleteGoal(){var e=this.read("goalShown");return delete e.g,this.write("goalShown",e)}migrateGoalShown(e,t){var n=this.read("goalShown");return n.g=n.g?n.g:{},n.g.sc=n.g.sc?n.g.sc:{},n.g.sc[e]=t,this.write("goalShown",n)}recordGoalShown(e){var t=this.read("goalShown");return t.g=t.g?t.g:{},t.g.sc=t.g.sc?t.g.sc:{},t.g.sc[e]=(t.g.sc[e]?t.g.sc[e]:0)+1,this.write("goalShown",t),t.g.sc[e]}getGoalShownList(){var e=this.read("goalShown");return e.g=e.g?e.g:{},e.g.sc||{}}recordGoalEngaged(e){var t=this.read("goalEngaged");return t.g=t.g?t.g:{},t.g.e=t.g.e?t.g.e:{},t.g.e[e]=1,this.write("goalEngaged",t),t.g.e[e]}getGoalEngageList(){var e=this.read("goalEngaged");return e.g=e.g?e.g:{},e.g.e||{}}resetGoal(){var e=this.read("goalEngaged");return delete e.g,this.write("goalEngaged",e)}migrateStartSessionTime(e){var t=this.read("userSessionStart");t.a=t.a||{},t.a.s=e,this.write("userSessionStart",t)}startSessionTime(){var e=this.read("userSessionStart");e.a=e.a||{},e.a.s=(new Date).getTime(),this.write("userSessionStart",e),this.resetSessionId()}getSessionStartTime(){var e=this.read("userSessionStart");return e.a=e.a||{},e.a.s||(e.a.s=(new Date).getTime(),this.write("userSessionStart",e)),new Date(e.a.s)}migrateEndSessionTime(e){var t=this.read("userSessionEnd");return t.a=t.a||{},t.a.e=e,this.write("userSessionEnd",t)}endSessionTime(){var e=this.read("userSessionEnd");e.a=e.a||{},e.a.e=(new Date).getTime(),this.write("userSessionEnd",e),this.deleteSessionId()}getLastSessionEndTime(){var e=this.read("userSessionEnd");return e.a=e.a||{},e.a.e?new Date(e.a.e):""}migrateSessionId(e){var t=this.read("sessionId");t.a=t.a||{},t.a.i=e,this.write("sessionId",t)}deleteSessionId(){var e=this.read("sessionId");return e.a=e.a||{},delete e.a.i,this.write("sessionId",e)}resetSessionId(){var t=this.read("sessionId");return t.a=t.a||{},t.a.i=e.guid_string(),this.write("sessionId",t),t.a.i}getSessionId(){var t=this.read("sessionId");return t.a=t.a||{},t.a.i||(t.a.i=e.guid_string(),this.write("sessionId",t)),t.a.i}setInTest(e,t){var n=this.readByCampaignId("inSplitTest",e);n.t=n.t||{},n.t.i=t,this.writeByCampaignId("inSplitTest",e,n)}getInTest(e){var t=this.readByCampaignId("inSplitTest",e);return t.t=t.t||{},t.t.i||null}setChosenCohort(e,t){var n=this.readByCampaignId("splitTestCohort",e);return n.t=n.t||{},n.t.c=t,this.writeByCampaignId("splitTestCohort",e,n)}getChosenCohort(e){var t=this.readByCampaignId("splitTestCohort",e);return t.t=t.t||{},t.t.c||null}setMergeId(e,t){var n=this.read("mergeId")||{};return n.mergeId=n.mergeId||{},n.mergeId[e]=t,this.write("mergeId",n)}getMergeId(e){var t=this.read("mergeId")||{};return t.mergeId=t.mergeId||{},t.mergeId[e]||-1}setOOS(e,t){var n=this.read("oos")||{};return t?(n.oos=n.oos||{},n.oos[e]=1):n.oos&&delete n.oos[e],this.write("oos",n)}getOOS(e){var t=this.read("oos")||{};return t.oos&&t.oos[e]}brandNewDay(e){this.eraseShowCount(e),this.unHideSession(e),this.openSession(e),this.setUnEngaged(e),this.eraseSubscription()}report(t){let n="getNewVisitor,getSessionShowCount,getReferral,getGoalShownList,getGoalEngageList,getSessionStartTime,getLastSessionEndTime,getSessionId,isSubscribed".split(",").map((n=>{let s=this[n]();if(!e.empty(s)||t)return[n,s]})).filter((e=>e));return Object.fromEntries(n)}reportCampaign(t,n){let s="getUTMInclude,getQueryInclude,getSequence,getPagesVisitedCountPerSession,getPagesVisitedCount,getPagesVisitedCountSetted,getPagesVisitedCountPerSessionSetted,getShowCount,getInTest,getChosenCohort,getMergeId,hasConvertSessionEvent,isEngaged,isSessionHidden,isSessionClosed".split(",").map((s=>{let r=this[s](t);if((!e.empty(r)||n)&&-1!==r)return[s,r]})).filter((e=>e));return Object.fromEntries(s)}};return s.expose(m,"storage"),m})),sndefine("site-data",["utils","storage-instance","event-emitter","constants","core-sleeknote","global"],(function(e,t,n,s,r,i){let o=this;let a=new i.Map,l=r.custom("splitSiteData",!1);const c="SleekNote";function u(e){return e==c?"sleeknote":e}function d(e){let t="sleeknoteSiteData";return e!=c&&(t=e+".sitedata"),t}function g(){return t.read("siteData")||{}}function m(e){let t=g();return l?(t[e]||(t[e]={}),t[e]):t}function p(r,i,o){let a,c=m(i);for(let[t,n]of e.entries(r))c[t]!=n&&(c[t]=n,a=!0);if(a){let e=g();l&&(e[i]=c),t.write("siteData",e),o||n(s.CORE.EVENTS.SITEDATA,{NS:i,sessionData:c})}return a}function h(e,t,n){return"answer"==t?{question:n.attrs.question,answer:e}:e}const f=i.Symbol("NS");function y(e,t){return e[t]||(e[t]={id:t,formFields:{}})}function E(e){let t=u(e),n=function(e){let t=d(e);return o[t]||(o[t]={}),o[t]}(e);return n[t]||(n[t]={})}function S(t,n,s){if(s){let r=E(t),i=y(r,n);e.extend(i,s)}}return o.document.addEventListener(r.eventName,(function(t){if(t.data.command==s.CORE.COMMANDS.SUBMIT){let{formData:n,formElements:s,NS:r}=t.data,i=n.SleeknoteId;if(!s)return;let o={};for(let[t,r]of e.entries(s))t in n&&(o[t]=h(n[t],t,r));let a=y(E(r),i);e.extend(a.formFields,o),S(r,i,a)}})),{initialize:function(e){let{namespaces:t}=r;try{!t&&e&&(t=e)}catch(e){}for(let e of t){if(a.has(e))continue;let t=d(e),n=u(e);if(Array.isArray(o[t]))for(let n of o[t])p(n,e,!0);class s extends i.Object{constructor(e){super(),i.Object.defineProperty(this,f,{value:e}),i.Object.defineProperty(this,n,{writable:!0,value:{}})}push(e){p(e,this[f])}pushNoEvent(e){p(e,this[f],!0)}}o[t]=i.Object.seal(new s(e)),a.set(e,o[t])}},getSession:m,getSitedataObject:function(e){if(e){let t=d(e);return o[t]}},saveToSitedataOwnData:S,readFromSitedataOwnData:function(e,t){let n=E(e);return y(n,t)},getSubmitted:function(e){let t=u(e.NS),n=d(e.NS);return(o[n]&&o[n][t]||{})[e.campaignId]}}})),sndefine("evaluator",["utils","location","core-sleeknote","site-data","constants","cookie","storage-instance","logger","targeting-evaluator","global"],(function(e,t,n,s,r,i,o,a,l,c){var u=this;const d=a.log(r.CORE.LOGLEVELS.CS,r.CORE.FORMATTERS.SNDEBUG);function g(e,t){return async function(t,n,s,r,i){d({msgs:[`- ${e.name}`],type:"groupCollapsed",styles:["group"]});var o=await E(e,"exclude",s.exclude,r,i);return o?o=await E(e,"include",s.include,r,i):t||"exclude",d({type:"groupEnd"}),d(o?{msgs:[`  ${e.name} passed`],styles:["success"]}:{msgs:[`  ${e.name} didn't pass`],styles:["error"]}),o}}function m(e,s,r){return C(e,t.get(n).matches(s))}function p(e,s,r){return C(e,t.get(n).contains(s))}async function h(e,t,n){let s=await o.fetchGeoInfo(t.addressComponents);let r;if((t=t||{}).sw)i=t.sw,a=t.ne,l={lat:+s.latitude,lng:+s.longitude},c=a.lng<i.lng?l.lng>=i.lng||l.lng<=a.lng:l.lng>=i.lng&&l.lng<=a.lng,r=l.lat>=i.lat&&l.lat<=a.lat&&c;else if(t.type&&"country"==t.type.toLowerCase())r=s.countryCode.toLowerCase()==t.addr.toLowerCase();else{r=[s.regionName.toLowerCase()+","+s.countryCode.toLowerCase(),s.regionCode.toLowerCase()+","+s.countryCode.toLowerCase()].indexOf((t.addr||"").toLowerCase())>-1}var i,a,l,c;return C(e,r)}async function f(t,n,s){let r=o.getIPAddress();if(e.empty(r)){if(r=await c.fetch("https://us-central1-mimir-181311.cloudfunctions.net/get_ip").then((e=>e.text())).then((e=>JSON.parse(e).userIP)).catch((()=>{})),e.empty(r))return!1;await o.setIPAddress(r)}function i(e){var t=e.trim().split("."),n=(t[0]?t[0]*Math.pow(256,3):0)+(t[1]?t[1]*Math.pow(256,2):0)+(t[2]?t[2]*Math.pow(256,1):0)+t[3];if(n<0)throw new Error(e+" is not a legal host ipaddr");return n}var a,l,u,d,g,m=(n=n||{}).split("-");return a=m[0],l=m[1]||a,C(t,(u=a,d=l,(g=i(r))>=i(u)&&g<=i(d)))}async function y(t,n,s,r){let i=await u.arequire("float-match");var o;await e.DOMContentLoaded();var a=n.target,l=!e.contains(n.target.charAt(0),"#",".");n.targetType?("class"==n.targetType&&l&&(a="."+a),"id"==n.targetType&&l&&(a="#"+a)):l&&(a="#"+a);var c=/^#\d/.test(a)?e.gid(a.slice(1)):e.qs(a);e.empty(c)?(o=C(t,"notExists"==n.matchType),n.matchType):o=C(t,i(e.parseNodeValue(c),n.matchType,n.value));return o}async function E(e,t,n,s,r){var i=(n||[]).length,o=!1;if(!i)return!0;for(d({msgs:["include"==t?"Show":"Hide"," campaign if value is one of:"],styles:["normal-bold","normal"]});i--;)if(d({msgs:[" - ",JSON.stringify(n[i])],styles:["normal","italic"]}),o=await e(t,n[i],s,r),"include"==t){if(o)return d({msgs:["   Value matched"],styles:["normal-bold"]}),!0;d({msgs:["   Value didn't match"],styles:["normal-bold"]})}else{if(!o)return d({msgs:["   Value matched"],styles:["normal-bold"]}),!1;d({msgs:["   Value didn't match"],styles:["normal-bold"]})}return o}function S(t){var n,s=[];for(Array.isArray(t)||(t=e.JSON.parse(t)),n=t.length;n--;){let e="matchType"in t[n]?t[n]:t[n].value;s.unshift(e)}return s}function v(t){var n={};return"string"==e.typeStr(t)&&(t=e.JSON.parse(t)),t.include&&(n.include=S(t.include)),t.exclude&&(n.exclude=S(t.exclude)),n}function I(t){return"string"==e.typeStr(t)&&(t=e.JSON.parse(t)),t}function C(e,t){return"exclude"==e?!t:t}return{includeNote:async function(t,n=[]){const s=async()=>{let s=t.rules&&t.rules.groups||[];let r=!1,i=!0;if(s.some((t=>!e.empty(t.conditions)))){d({msgs:["Conditions"],styles:["group"],type:"groupCollapsed"});for(let e=0;e<s.length;e++){try{r=await this.evaluateGroup(s[e].conditions,s[e].conditionAnd,t,n)}catch(e){console.error(e)}i=s[e].groupAnd?i&&r:i||r}d({type:"groupEnd"}),d(i?{msgs:["Conditions passed"],styles:["success"]}:{msgs:["Conditions didn't pass"],styles:["error"]})}else d({msgs:["Campaign has ","no conditions"],styles:["normal","normal-bold"]});return i};if(!t.targeting||t.targeting.doNotUse)return await s();d({msgs:["Targeting"],styles:["group"],type:"groupCollapsed"});try{const e=await l.evaluate(t);let n;return d({type:"groupEnd"}),e?(d({msgs:["Targeting passed"],styles:["success"]}),n=await s()):(s(),d({msgs:["Targeting didn't passed"],styles:["error"]})),e&&n}catch(e){console.log(e)}},evaluateArraySome:E,evaluateGroup:async function(t,n,s,r){var i,o,a,l,c=0,u=n;if(!t||!t.length)return!0;for(d({msgs:["Group ",n?"AND":"OR"," has ",t.length," conditions:"],styles:["normal","normal-bold","normal","normal-bold","normal"]});c<t.length;c++){i=t[c];var g=this.evaluatorFunctions[i.type].formatValue,m=this.evaluatorFunctions[i.type].evaluate;"object"==e.typeStr(i)&&(l=g?g(i.value):i.value,a=i.matchType,o=!(!r||!~r.indexOf(i.type))||await m(n,a,l,s,i),u=n?u&&o:u||o)}return u},evaluatorFunctions:{1:{evaluate:function(e,t,n,s){function r(e){function t(e){return"/"==e[e.length-1]?e.substring(0,e.length-1):e}function n(e){return"www."==e.substring(0,4)?e.substring(4,e.length):e}const s=u.location,r=function(e){try{const t=e.includes("http")?e:`https://${e}`;return new c.URL(t)}catch(e){console.error(e)}}(e);return["hostname","pathname","search","hash"].every((e=>{let i=s[e],o=r[e];if(("search"==e||"hash"==e)&&!o)return!0;if("hostname"==e&&(i=n(i),o=n(o)),"pathname"==e&&(o=t(o),i=t(i),o.includes("*"))){let[e,n]=o.split("*");e=t(e);const s=!e||t(i.substring(0,e.length)).toUpperCase()==e.toUpperCase(),r=!n||i.substring(i.length-n.length,i.length).toUpperCase()==n.toUpperCase();return s&&r}return o.toUpperCase()==i.toUpperCase()}))}var i=o.getSequence(s.CampaignId);d({msgs:["- Sequence"],type:"groupCollapsed",styles:["group"]}),d({msgs:["Show campaign if sequence",` ${"include"==t?"matches":"doesn't match"} `,n],styles:["normal","normal-bold","italic"]}),i.length<n.length&&(r(n[i.length])?i.push(1):i.length-1>=0&&r(n[i.length-1])||(i.length=0));let a;d({msgs:["Pages visited from sequence: ",i.length],styles:["normal","normal-bold"]}),o.setSequence(s.CampaignId,i),i.length==n.length?(d({msgs:["Sequence matched"],styles:["normal-bold"]}),a=C(t,!0)):(d({msgs:["Sequence didn't match"],styles:["normal-bold"]}),"exclude"==t&&(a=!0));d({type:"groupEnd"}),d(a?{msgs:["  Sequence passed"],styles:["success"]}:{msgs:["  Sequence didn't pass"],styles:["error"]});return a},formatValue:S},2:{evaluate:async function(e,s,r,i){let a=await o.isSubscribed();d({msgs:["- Newsletter Subscriber"],type:"groupCollapsed",styles:["group"]}),d({msgs:["Show campaign if user ",("include"==s?"is":"is not")+" ","subscribed to the newsletter"],styles:["normal","normal-bold","normal"]}),a||(a=n.isSubscribedFromQuery||r.extraParam&&~String(t.get(n)).indexOf(r.extraParam),a&&o.setSubscription());!a&&r.extraParam&&(a=~String(t.get(n)).indexOf(r.extraParam));a=r.value?a&&r.value:a&&r;d(a?{msgs:["User ","is"," subscribed already"],styles:["normal","normal-bold","normal"]}:{msgs:["User ","is not"," subscribed yet"],styles:["normal","normal-bold","normal"]});var l=C(s,a);d({type:"groupEnd"}),d(l?{msgs:["  Newsletter Subscriber passed"],styles:["success"]}:{msgs:["  Newsletter Subscriber didn't pass"],styles:["error"]});return l},formatValue:function(t){"boolean"!=e.typeStr(t)&&(t=e.JSON.parse(t));return t}},3:{evaluate:function(e,t,n,s){d({msgs:["- New Visitor"],type:"groupCollapsed",styles:["group"]}),d({msgs:["Show campaign if user ",("include"==t?"is":"is not")+" ","a new visitor"],styles:["normal","normal-bold","normal"]});const r=o.newVisitor;d(r?{msgs:["User ","is"," a new visitor"],styles:["normal","normal-bold","normal"]}:{msgs:["User ","is not"," a new visitor"],styles:["normal","normal-bold","normal"]});var i=C(t,r);d({type:"groupEnd"}),d(i?{msgs:["  New Visitor passed"],styles:["success"]}:{msgs:["  New Visitor didn't pass"],styles:["error"]});return i}},4:{evaluate:g(m),formatValue:v},5:{evaluate:function(s,r,i,a){d({msgs:["- Specific Query"],type:"groupCollapsed",styles:["group"]});var l=o.getQueryInclude(a.CampaignId);const u=t.get(n).queryParams();if(d({msgs:["Current queries are: ",c.replaceAll?JSON.stringify(u).replaceAll(":","="):JSON.stringify(u)],styles:["normal","normal-bold"]}),e.empty(u)&&l){const e=l>0;return d(e?{msgs:["This condition was already evaluated to pass in this session"],styles:["success"]}:{msgs:["This condition was already evaluated to not pass in this session"],styles:["error"]}),e}{const l=function(s,r,i,a){function l(s,r,i,o){e.empty(i)||d({msgs:["include"==r?"Show":"Hide"," campaign if we have this queries: ",`${i.map((e=>`${e[0].key}=${e[0].value}`)).join(", ")}`],styles:["normal-bold","normal","normal-bold"]});var a=t.get(n).queryParams(),l=0;if(i.length){if(i.forEach((function(e){var t=e[0].key,n=e[0].value;t in a&&a[t]==n&&l++})),l==i.length)return d({msgs:["Queries ","found"],styles:["normal","normal-bold"]}),l="include"==r?1:-1;l=0,d({msgs:["Queries ","not found"],styles:["normal","normal-bold"]})}return l}var c,u,g=o.getQueryInclude(a.CampaignId);if(c=l(0,"exclude",i.exclude||[]))return s||(r="exclude"),o.setQueryInclude(a.CampaignId,c),{result:!1,matchType:r};if(u=l(0,"include",i.include||[]))return o.setQueryInclude(a.CampaignId,u),{result:!0,matchType:r};if(!c&&!u){const e=g?g>0:!(i.include||[]).length;return d(e?{msgs:["This condition was already evaluated to pass in this session, ignoring condition result"],styles:["success"]}:{msgs:["This condition was already evaluated to not pass in this session, ignoring condition result"],styles:["error"]}),{result:e,matchType:r}}}(s,r,i,a);return r=l.matchType,d({type:"groupEnd"}),l.result?d({msgs:["  Specific Query passed"],styles:["success"]}):d({msgs:["  Specific Query didn't pass"],styles:["error"]}),l.result}},formatValue:v},6:{evaluate:function(t,n,s,r){d({msgs:["- Specific Referral"],type:"groupCollapsed",styles:["group"]}),d({msgs:["Show campaign if referral ",""+("include"==n?"is":"is not")," one of ",s],styles:["normal","normal-bold","normal","italic"]});var i=o.getReferral();d({msgs:["Current referral is ",i||"none"],styles:["normal","normal-bold"]});var a=i&&s.some((function(t){return t.split(",").some((function(t){return e.cleanUpReferral(t).toLowerCase()==i.toLowerCase()}))}));d(a?{msgs:["Referral matched"],styles:["normal-bold"]}:{msgs:["Referral didn't match"],styles:["normal-bold"]});var l=C(n,a);d({type:"groupEnd"}),d(l?{msgs:["  Specific Referral passed"],styles:["success"]}:{msgs:["  Specific Referral didn't pass"],styles:["error"]});return l},formatValue:S},7:{evaluate:function(e,s,r,i){function a(e,t,n){var s,r,i,o=e.split(",");for(s=0;s<t.length;s++)for(i=t[s].matchType,r=0;r<o.length;r++)if("exactMatch"==i){if(t[s].value==o[r])return!0}else if("contains"==i&&~o[r].indexOf(t[s].value))return!0}d({msgs:["- UTM Campaign"],type:"groupCollapsed",styles:["group"]});let l="";Object.keys(r).forEach((e=>{l+=`\n - ${e}: `,r[e].forEach(((t,n)=>{l+=`${"exactMatch"==t.matchType?"matches":"contains"} ${t.value}`,n!=r[e].length-1&&(l+=" or ")}))})),d({msgs:[""+("include"==s?"Show":"Hide")," campaign if UTM queries: ",l],styles:["normal-bold","normal","italic"]});var u=t.get(n).queryParams();d({msgs:["Current queries are ",c.replaceAll?JSON.stringify(u).replaceAll(":","="):JSON.stringify(u)],styles:["normal","normal-bold"]});var g=o.getUTMInclude(i.CampaignId);if(g){const e=g>0;return d(e?{msgs:["This condition was already evaluated to pass in this session"],styles:["success"]}:{msgs:["This condition was already evaluated to not pass in this session"],styles:["error"]}),d({type:"groupEnd"}),d(e?{msgs:["  UTM Campaign passed"],styles:["success"]}:{msgs:["  UTM Campaign didn't pass"],styles:["error"]}),e}var m=function(e,t){var n,s,r;for(n in t)if(t.hasOwnProperty(n)){for(r in s=!0,e)if(n.toLowerCase()==r.toLowerCase()&&(s=!1,!a(e[r],t[n])))return!1;if(s)return!1}return!0}(u,r);d(m?{msgs:["UTM queries matched"],styles:["normal-bold"]}:{msgs:["UTM queries didn't match"],styles:["normal-bold"]});var p=C(s,m);o.setUTMInclude(i.CampaignId,p?1:-1),d({type:"groupEnd"}),d(p?{msgs:["  UTM Campaign passed"],styles:["success"]}:{msgs:["  UTM Campaign didn't pass"],styles:["error"]});return p},formatValue:I},8:{evaluate:function(e,t,n,s){if(s.hiddenSleeknote)return!0;d({msgs:["- Show Count"],type:"groupCollapsed",styles:["group"]}),d({msgs:["Hide"," campaign when show count is ",n],styles:["normal-bold","normal","normal-bold"]});var r=o.getShowCount(s.CampaignId);d({msgs:["Current show count is ",r],styles:["normal","normal-bold"]});const i=r>=n;d(i?{msgs:["Show Count matched"],styles:["normal-bold"]}:{msgs:["Show Count didn't match"],styles:["normal-bold"]});var a=C(t,i);d({type:"groupEnd"}),d(a?{msgs:["  Show Count passed"],styles:["success"]}:{msgs:["  Show Count didn't pass"],styles:["error"]});return a}},9:{evaluate:async function(e,t,n,s){let r=await u.arequire("float-match");function o(e,t,n){function s(e,t,n){if(!t.target){var s=(t.value||t).split("=");t={target:s[0],matchType:s.length>1?"exactMatch":"exists",value:s[1]}}var o=i.getItem(t.target,!0);null===o&&d({msgs:["  ",t.target," not found"],styles:["normal","italic","normal-bold"]});const a=r(o,t.matchType,t.value);return null!=o&&d({msgs:["  Cookie ",o," "+(a?"matched":"didn't match")],styles:["normal","italic","normal-bold"]}),C(e,a)}t||(t=[]);var o=t.length;if(!o)return!0;const a=t.map((e=>`${e.target} ${e.matchType}${"exists"!=e.matchType?` ${e.value}`:""}`)).join("include"==e?" and ":" or ");if(d({msgs:[""+("include"==e?"Show":"Hide")," campaign if: ",a],styles:["normal-bold","normal","normal-bold"]}),"include"!=e){for(;o--;)if(!s(e,t[o]))return d({msgs:["Hide cookies matched"],styles:["normal-bold"]}),!1;return d({msgs:["Hide cookies didn't match"],styles:["normal-bold"]}),!0}for(;o--;)if(!s(e,t[o])){d({msgs:["Show cookies didn't match"],styles:["normal-bold"]});break}return-1==o?(d({msgs:["Show cookies matched"],styles:["normal-bold"]}),!0):void 0}d({msgs:["- Specific Cookie"],type:"groupCollapsed",styles:["group"]});var a=o("exclude",n.exclude);a?a=o("include",n.include):e||"exclude";d({type:"groupEnd"}),d(a?{msgs:["  Specific Cookie passed"],styles:["success"]}:{msgs:["  Specific Cookie didn't pass"],styles:["error"]});return a},formatValue:v},10:{evaluate:g(p),formatValue:v},11:{evaluate:g(h),formatValue:v},12:{evaluate:g(y),formatValue:I},13:{evaluate:async function(t,n,r,i){let o=await u.arequire("float-match");function a(t,n,r){let i=e.findPropValue(s.getSession(r.NS),n.target);return C(t,o(i,n.matchType,n.value))}function l(e,t,n,s){if(!(n=n||[]).length)return!0;d({msgs:["include"==t?"Show":"Hide"," campaign if SiteData values are:"],styles:["normal-bold","normal"]});var r=n.every((function(n){d({msgs:[" - ",`${n.target} ${n.matchType}${"exists"==n.matchType||"notexists"==n.matchType?"":` ${n.value}`}`],styles:["normal","italic"]});var r=e(t,n,s);return"include"!=t&&(r=!r),d(r?{msgs:["  SiteData value matched"],styles:["normal-bold"]}:{msgs:["  SiteData value didn't match"],styles:["normal-bold"]}),r}));return"include"==t?r:!r}d({msgs:["- SiteData"],type:"groupCollapsed",styles:["group"]});var c=l(a,"exclude",r.exclude,i);c?c=l(a,"include",r.include,i):t||"exclude";d({type:"groupEnd"}),d(c?{msgs:["  SiteData passed"],styles:["success"]}:{msgs:["  SiteData didn't pass"],styles:["error"]});return c},formatValue:I},14:{evaluate:function(e,t,n,s){var i=0;d({msgs:["- Pages Visited"],type:"groupCollapsed",styles:["group"]}),d({msgs:["include"==t?"Show":"Hide"," campaign if user has visited more than ",n.value," pages during ",n.option],styles:["normal-bold","normal","normal-bold","normal","normal-bold"]}),a=n.option,l=s.CampaignId,i=a==r.CONDITIONS.PAGESVISITEDOPTIONS.ONESESSION?o.getPagesVisitedCountPerSession(l)||0:o.getPagesVisitedCount(l)||0,function(e,t){e!=r.CONDITIONS.PAGESVISITEDOPTIONS.ONESESSION||o.getPagesVisitedCountPerSessionSetted(t)?e!=r.CONDITIONS.PAGESVISITEDOPTIONS.ALLSESSIONS||o.getPagesVisitedCountSetted(t)||(i+=1,o.setPagesVisitedCount(t,i),o.setPagesVisitedCountSetted(t,!0)):(i+=1,o.setPagesVisitedCountPerSession(t,i),o.setPagesVisitedCountPerSessionSetted(t,!0))}(n.option,s.CampaignId),d({msgs:["Current number of Pages Visited is: ",i],styles:["normal","normal-bold"]});var a,l;const c=n.value<=i;var u=C(t,c);d(c?{msgs:["Pages Visited matched"],styles:["normal-bold"]}:{msgs:["Pages Visited didn't match"],styles:["normal-bold"]});d({type:"groupEnd"}),d(u?{msgs:["  Pages Visited passed"],styles:["success"]}:{msgs:["  Pages Visited didn't pass"],styles:["error"]});return u},formatValue:I},15:{evaluate:g(f),formatValue:v}},evaluateURL:m,containsURL:p,containsGEOID:h,containsIPAddress:f,evaluateHtmlElementValue:y,match:C}})),sndefine("preprocessor-utils",["browser","constants","core-sleeknote","evaluator","utils","storage-instance","location"],(function(e,t,n,s,r,i,o){var a=this,l=a.document,c=t.PROFILE;let u=t.POS;function d(){return e.is.phone&&n.hasCustomProp("isRealMobileSite")?!!n.custom("isRealMobileSite"):!e.is.phone||e.notScaledMobileContent()}function g(t,s){var r;if(s?r=(n.editor||n.preview)&&"test"!=n.editor?"mobile"==(n.editor||n.preview).profile?c.MOBILE:c.DESKTOP:e.is.desktop?c.DESKTOP:e.is.tablet?c.TABLET:c.MOBILE:(n.hasCustomProp("displayStatus")&&(r=n.custom("displayStatus")(e,n,t,c)),n.hasCustomProp("displayStatus")&&void 0!==r||(r=c.IGNORE,Array.isArray(t.rules.display)?e.is.desktop?~t.rules.display.indexOf(1)&&(r=c.DESKTOP):e.is.tablet?~t.rules.display.indexOf(1)&&(r=c.TABLET):~t.rules.display.indexOf(2)&&(r=c.MOBILE):e.is.desktop?~[1,3].indexOf(t.rules.display)&&(r=c.DESKTOP):e.is.tablet?~[1,2].indexOf(t.rules.display)&&(r=c.TABLET):~[1,2].indexOf(t.rules.display)&&(r=c.MOBILE))),!s){let s=d();r!=c.MOBILE||s||(r=n.hasCustomProp("displayStatus")&&n.custom("displayStatus")(e,n,t,c)==c.MOBILE?c.MOBILE:c.TABLET)}return r}function m(e){return e==c.MOBILE?1:0}function p(e,t,n,s){var r=n[e];return Array.isArray(r)&&(r=r[m(s)]),void 0===r&&(r=t),r}function h(e,t){return+e.Version||2}function f(e,t){return y(e,t)==u.EMBEDDED}function y(e,t){let n=g(e,t),s=+p("BoxAndBarAlignment",u.POPUP,e,n);return s==u.POPUP&&(s=n==c.MOBILE?u.SLIDEUP:u.POPUP2),n!=c.TABLET||r.contains(s,u.HELLO,u.HELLO2,u.EMBEDDED,u.SIDEBAR_RIGHT,u.SIDEBAR_LEFT)||(s=s==u.BOTTOM_LEFT?u.POPUP7:s==u.BOTTOM_RIGHT?u.POPUP9:u.POPUP5),n==c.MOBILE&&(s<=u.BOTTOM_RIGHT||s==u.POPUP2)&&(s=u.SLIDEUP),s}function E(e,t){let n=h(e)>3;return n&&e.steps.forEach((e=>{let t,n,s,i,o=!1;for(let a of r.values(e))"form"==a.type&&(n=a),"teaser"==a.type&&(s=a),"success"==a.type&&(i=a),o?"form"==a.type&&(a.teaser=t.name,t.success=a.name):o=a,t=a,delete a.teasers,delete a.successes;s?(o.teaser=s.name,s.form=o.name):delete o.teaser,i?n.success=i.name:delete n.success})),n?e.steps[m(g(e,t))]:e.steps}var S={};return{isRealMobileSite:d,teaserExist:function(e){let t=E(e);return!!Object.keys(t).filter((function(e){return"teaser"==t[e].type})).length},deleteTeaserIf:function(e){e&&e.steps&&Object.keys(e.steps).forEach((function(t){"teaser"==e.steps[t].type&&delete e.steps[t]}))},parseOnClick:async function(e){let t;try{await r.DOMContentLoaded(),t=JSON.parse(e),t.selector=(t.classes||[]).reduce((function(e,t){try{l.body.querySelector("."+t.value)&&e.push("."+t.value)}catch(n){const s="."+a.CSS.escape(t.value);l.body.querySelector(s)&&e.push(s)}return e}),[]).concat((t.ids||[]).reduce((function(e,t){try{l.body.querySelector("#"+t.value)&&e.push("#"+t.value)}catch(e){}return e}),[])).join(","),(t.selector&&l.body.querySelectorAll(t.selector)||[]).length||(t=!1)}catch(e){t=!1}return t},getProfile:g,getPlacement:function(e,t){return p("placement",void 0,e,f(e,t)?c.DESKTOP:g(e,t))},isAnyConditions:function(e){for(var t=e.rules&&e.rules.groups||[],n=0;n<t.length;n++)if(t[n].conditions&&t[n].conditions.length)return!0;return!1},getVersion:h,isSleekbar:function(e,t){return r.contains(y(e,t),u.HELLO,u.HELLO2)},isEmbedded:f,getPosition:y,getShowTeaser:function(e,t){return p("ShowTeaser",!1,e,g(e,t))},getSteps:E,evaluate:async function(e,t,n){let i;if(t)i=!0;else try{e.CampaignId in S?i=S[e.CampaignId]:(i=await s.includeNote(e,n),S[e.CampaignId]=i)}catch(t){console.log("evaluator error:",e.CampaignId,t),S[e.CampaignId]=i=!1}if(i){y(e,t)==u.EMBEDDED&&(await r.DOMContentLoaded(),i=function(e,t){function n(e){return"#"!=e.charAt(0)&&(e="#"+e),r.qs(e)}if(!Array.isArray(e.placement))return!!e.placement;let[s,i]=e.placement;return g(e,t)==c.MOBILE?e.placement=n(i)||n(s):e.placement=n(s),!!e.placement}(e,t))}return i},resetEvaluator:function(){S={}},getConfProp:function(e,t,n){return p(e,t,n,g(n,!1))},isCorrectDomain:function(e){if(!0===n.local||void 0===e.Hostname||n.preview)return!0;return o.get(n).domainMatches(e.Hostname)},isSessionHidden:function(e){return!n.preview&&i.isSessionHidden(e.CampaignId)},isSessionClosed:function(e){return!n.preview&&i.isSessionClosed(e.CampaignId)}}})),sndefine("preprocessor",["browser","utils","core-sleeknote","storage-instance","logger","constants","preprocessor-utils","global"],(function(e,t,n,s,r,i,o,a){var l=i.PROFILE,c=i.POS;let{getProfile:u,getPlacement:d,getVersion:g,isSleekbar:m,isEmbedded:p,getPosition:h,getShowTeaser:f,getSteps:y,evaluate:E,resetEvaluator:S,getConfProp:v,isCorrectDomain:I,isSessionHidden:C,isSessionClosed:w,parseOnClick:T,teaserExist:O,deleteTeaserIf:b}=o;var A=this;async function N(e,s,o,a){if(!Array.isArray(e))return[];let c,d={};e.length&&(e.forEach((function(e){e.Version<=3&&(e.steps={form:{type:"form",teaser:"teaser"}});let t=u(e,s),n=O(e)&&t==l.MOBILE;(m(e)||p(e)||n)&&(e.rules.triggers=n?e.rules.triggers.filter((e=>2==e.type||4==e.type||5==e.type)):[],e.smarts=void 0),m(e)&&b(e)})),e.some((function(e,t){let n=u(e,s);return n!=l.MOBILE&&n!=l.IGNORE?e.smarts:void 0}))&&(c=await A.arequire("split-tests"),({splitTests:d,sleekNotes:e}=c.generateFromSmarts(e,s))));let g=r.log(i.CORE.LOGLEVELS.CS,i.CORE.FORMATTERS.SNDEBUG),h=[];S(),s||g({msgs:["CAMPAIGNS:"],styles:["color: rgb(84, 87, 255); font-weight: bold; font-size: 16px;"],type:"group"});for(let[l,c]of t.entries(e)){g=c.smartIndex&&"1"!=c.smartIndex[0]||s?()=>{}:r.log(i.CORE.LOGLEVELS.CS,i.CORE.FORMATTERS.SNDEBUG),g({msgs:[`${n.getCampaignName(c)} - ${c.CampaignId}`],type:"groupCollapsed",styles:["group"]});let e=!1,t=!1;try{"outofstock"!=c.SleeknoteType||s||n.preview?e=await P(c,d,l,s,g,o,a):t=!0}catch(e){}g({type:"groupEnd"}),e?g({msgs:["INCLUDED"],styles:["success"]}):t||g({msgs:["REJECTED"],styles:["error"]}),h.push(e)}!c&&h.some((function(e){return e&&e.splitTestId}))&&(c=await A.arequire("split-tests"));let f=c?c.filterConfig(h,d,s):h.filter((e=>e));return s||console.groupEnd(),f}async function P(e,o,a,S,b,N,P){function R(t,n){for(var s=e.rules.triggers.length;s--;)if(e.rules.triggers[s].type==t)return e.rules.triggers[s].value;return n}const k=0===R(1,void 0)?-1:R(1,0),D=0===R(2,void 0)?-1:R(2,0),M=R(5,!1);var L={options:e.advOptions||[],profile:u(e,S),campaignId:e.CampaignId,type:e.SleeknoteType,customerId:e.CustomerId,summaryId:e.summaryId,smartIndex:e.smartIndex,version:g(e,S),triggers:e.rules.triggers,campaignName:e.campaignName,integrationName:e.integrationName,placement:p(e)?e.placement:d(e,S),splitTestId:e.SplitTestId,wait:w(e)?0:1e3*k,exit:!w(e)&&R(3,!1),scroll:!w(e)&&D,hidden:R(4,!1),onClick:M&&await T(M),siteData:R(7,!1),multimerge:e.multimerge,NS:e.NS,campaignType:e.campaignType,quizOutcomes:e.quizOutcomes,managed:e.managed};if(L.siteData)try{L.siteData=JSON.parse(L.siteData)}catch(e){L.siteData=!1}let x;if(L.version<4&&(L.successAction=v("SuccessAction",void 0,e),L.successLandingPage=v("SuccessLandingPage",void 0,e)),S)x=!0,"outofstock"!=(L=t.extend(L,{hidden:!n.editor&&!n.preview})).type&&(b=r.log(i.CORE.LOGLEVELS.CS,i.CORE.FORMATTERS.SNDEBUG))({msgs:["SLEEKNOTE MESSAGE:"," manual trigger triggered on rejected campaign, ignoring rules and showing the campaign anyway."],styles:["message","normal-bold"]});else if(791==L.customerId&&n.hasCustomProp("demoCampaignIds")&&n.custom("demoCampaignIds").some((e=>e==L.campaignId)))b({msgs:["Demo campaign always shows"],styles:[""]}),x=!0;else{if(!I(e))return b({msgs:["Campaign domain doesn't match current domain"],styles:["error"]}),void(L.profile=l.IGNORE);if(L.profile<3)return void b({msgs:["Profile(Mobile/Desktop) doesn't match current one"],styles:["error"]});const r=n.getDomainLimits&&n.getDomainLimits()||{},o=r[e.Hostname]||r["All non-selected domains"],a=t.getAdvOption({options:e.advOptions},"impressionOverride",1),c=s.getSessionShowCount(),u=N&&P.includes(e.CampaignId);if(!u&&(void 0!==o&&c>=o)){if(!a)return b({msgs:[`The limit of ${o} impressions for this domain has been reached with ${c} campaigns shown in this session, more info: https://help.sleeknote.com/advanced-use/impression-limit`],styles:["error"]}),void(L.profile=l.IGNORE);b({msgs:["Ignoring impression limit, more info: https://help.sleeknote.com/hc/en-us/articles/7006752027037-Impression-Limit"],styles:["normal"]})}let d=L.multimerge;if(d&&"DateMultiMerge"==d.type){let e,t=new Date,r=[t.getFullYear(),t.getMonth(),t.getDate()];e=void 0!==n.mergeId?d.rows[n.mergeId]:d.rows.find((e=>e[d.id].join()==r.join())),e&&(L.multimergeCurrent=Array.from(e),s.setMergeId(L.campaignId,r));let i=s.getMergeId(L.campaignId,r);Array.isArray(i)&&i.join()!=r.join()&&s.brandNewDay(L.campaignId)}const g=R(5);let h=!u&&C(e);if(h&&!g||(x=await E(e,!1,u&&N)),!x)return h&&!g&&b({msgs:["Campaign is hidden for this session because it has been already seen and closed"],styles:["error"]}),void(L.profile=l.IGNORE);if(p(e)&&(L.placement=e.placement),!t.empty(e.advOptions)){const t=e.advOptions.find((e=>"note-priority"==e.id));t&&t.values.length&&b({msgs:["Campaign order is ",t.values[0].value],styles:["normal","normal-bold"]})}if(t.empty(e.rules.triggers)||m(e)||p(e)){if(!(m(e)||p(e)||O(e)))return b({msgs:["Campaign doesn't have triggers or teaser so it can't show"],styles:["error"]}),void(L.profile=l.IGNORE);b({msgs:["Campaign has ","no triggers"],styles:["normal","normal-bold"]})}else if(e.smarts&&e.smartIndex&&1==e.smartIndex.substring(0,1))b({msgs:["Campaign trigger is ","automated",", a split-test has been created"],styles:["normal","normal-bold","normal"]});else{b({msgs:["Campaign triggers are:"],styles:["normal"]}),e.rules.triggers.forEach((({type:e})=>{let n=R(e);try{n=JSON.parse(R(e))}catch(e){}switch(e){case 1:b({msgs:[`- ${i.TRIGGERS.TYPES[e]} `,n," seconds"],styles:["normal","normal-bold","normal"]});break;case 2:b({msgs:[`- ${i.TRIGGERS.TYPES[e]} `,n,"%"],styles:["normal","normal-bold","normal"]});break;case 3:case 4:b({msgs:[`- ${i.TRIGGERS.TYPES[e]}`],styles:["normal"]});break;case 5:b({msgs:[`- ${i.TRIGGERS.TYPES[e]}:`],styles:["normal"]});const s=n.classes.map((e=>e.value)).join(", "),r=n.ids.map((e=>e.value)).join(", ");t.empty(s)||b({msgs:["    Classes: ",s],styles:["normal","normal-bold"]}),t.empty(r)||b({msgs:["    Ids: ",r],styles:["normal","normal-bold"]});break;case 7:b({msgs:[`- ${i.TRIGGERS.TYPES[e]}:`],styles:["normal"]}),n.forEach((e=>b({msgs:["    ",`${e.property} ${e.type} ${e.value}`],styles:["normal","normal-bold"]})))}}));const n=L.wait||L.exit||L.scroll||L.hidden||L.onClick||L.siteData;if(!(n||m(e)||O(e)||u))return b({msgs:["Campaign doesnt have teaser and was already triggered this session so it won't show"],styles:["error"]}),void(L.profile=l.IGNORE);n||b({msgs:["Campaign"," has already been triggered this session",", we won't automaticly trigger it again"],styles:["normal","normal-bold","normal"]})}b({msgs:[["ZERO?","UNKN","IGNORE","DESKTOP","TABLET","MOBILE"][L.profile]," version was chosen"],styles:["normal-bold","normal"]})}var U=h(e);if((L.hidden||m(e)||p(e))&&(L.wait=0,L.exit=!1,L.scroll=0),L.version<=3){var B=f(e);B||!1===B||(B=!0),L.profile==l.MOBILE&&L.version<3&&(B=!1),U==c.POPUP&&L.version<3&&(B=!1),(m(e)||1==L.version&&U==c.POPUP2)&&(B=!1),B&&(e.steps.teaser={type:"teaser",form:"form"}),"SuccessStep"==L.successAction?(e.steps.success={type:"success"},e.steps.form.success="success"):"redirect"==L.successAction&&L.successLandingPage?e.steps.form.redirect=L.successLandingPage:delete e.steps.success,delete L.successAction,delete L.successLandingPage}n.tabletUsesMobile=!1,L.position=U;var V=L.profile==l.MOBILE,_=y(e);return L.steps={},L.profile==l.MOBILE&&O(e)&&(L.wait=0),Object.keys(_).forEach((function(n){var s,r=t.extend({},_[n],{name:n,mobile:V,campaignId:L.campaignId,customerId:L.customerId,version:L.version,position:U,placement:L.placement,profile:L.profile,hostname:e.Hostname,noteType:L.type,campaignName:e.campaignName,integrationName:e.integrationName,formElements:e.formElements,NS:L.NS,quizOutcomes:L.quizOutcomes});t.empty(r.redirect)||"string"!=t.typeStr(r.redirect)||(r.redirect=(~(s=r.redirect).indexOf("http://")||~s.indexOf("https://")?"":"//")+s),L.version>3?r.id="#sleeknote-"+n.replace(/[^a-zA-Z0-9\-\_\:\.\[\]]/g,""):r.id="teaser"==r.type?"#sleeknoteMinified":"form"==r.type?"#sleeknoteBox":"#sleeknoteSuccess",L.profile,l.TABLET,L.profile==l.DESKTOP&&(r.relativeWidth=0),t.contains(r.type,"teaser")&&(L.profile,l.TABLET,L.profile==l.DESKTOP&&(r.relativeWidth=0)),L.steps[n]=r})),Object.keys(L.steps).forEach((function(t){var n=L.steps[t];n.timeZoneOffset=e.timeZoneOffset||0,n.timeZone=e.timeZone,n.locale=e.locale||(A.navigator.userLanguage||A.navigator.language).split("-")[0]})),L.splitTestId&&(o[L.splitTestId]||(o[L.splitTestId]=[]),o[L.splitTestId].push(a)),L}return A.dev.generateConfig=N,N})),sndefine("launcher",["core-sleeknote","constants","event-emitter","browser","utils","storage-instance","location","preprocessor","preprocessor-utils","global","logger"],(function(e,t,n,s,r,i,o,a,l,c,u){var d=this,g=d.document,m=0;const p=u.log(t.CORE.LOGLEVELS.CS,t.CORE.FORMATTERS.SNDEBUG),h=t.CORE.CREATOR.API,f=t.CORE.COMMANDS;let y,E,S,v=[],I=[],C=Object.create(null),w=Object.create(null),T=[],O=-1,b=String(o.get(e));function A(t){let n="beforeCampaignCreate";return e.hooks[n]&&e.hooks[n](t),!(t.multimerge&&!t.multimergeCurrent)||(p({msgs:[`No mergedata for campaign '${t.campaignId}' was found`],styles:["error"]}),!1)}async function N(e,n){let s=Object.keys(C);l.resetEvaluator(),i.resetMemData();let o=[],a=[];v.forEach((function(e){let t=e.CampaignId;~s.indexOf(t)&&o.push(e),a.push(e)})),I.length=0,T.length=0,O=-1;let c=await L(a,!1,!1,e==t.CORE.EVENTS.SITEDATA&&[2,8,14],o.map((e=>k(e)))),u=c.length;if(o.length&&u)for(;u--;){let e=M(k(c[u]),o);if(~e){if(n){let t=k(o[e]);n(await C[t])}c.splice(u,1),o.splice(e,1)}}for(let e of r.values(o)){let t=k(e),n=await C[t];m&&console.log("erase",t),await R(t,!0),n.destroy(!0,!1,!0)}U(c)}async function P(){let t=o.reset(e);t.matches(b,e.custom("reloadOnHashChange"))||(N(),b=String(t))}async function R(e,t){if(!C[e])return;let n=(await C[e]).config.position,s=M(e,I);if(~s){I.splice(s,1);let e=T.indexOf(n);~e&&T.splice(e,1),O==n&&(O=-1)}t||(s=M(e,v),~s&&v.splice(s,1)),delete C[e],delete w[e]}function k(e){return e.CampaignId||e.campaignId}function D(e){let n,s=v.length;for(;s--;)if(n=v[s],k(n)==e&&l.getProfile(n)>t.PROFILE.IGNORE)return n.hiddenSleeknote=!0,n.SplitTestId="",a([n],!0).then((function(e){let t=e.shift();if(I.push(t),A(t))return H(t)}))}function M(e,t){for(let[n,s]of r.entries(t))if(k(s)==e)return n;return-1}async function L(e,t,n=!0,s,i){m&&console.log("add",...arguments);let o=[],l=[];if(!e)return l;if(Array.isArray(e)||(e=[e]),e.forEach((e=>{-1==M(k(e),v)&&v.push(e),o.push(e),!E&&r.getAdvOption({options:e.advOptions},"onepagesite",1)&&(E=c.setInterval(P,1e3))})),o.length){(await a(o,t,s,i)).forEach((e=>{M(e.campaignId,I)>-1||(I.push(e),l.push(e))})),l.length&&(l=x(l))}return n&&U(l),S=l,l}function x(n){return e.editor||(n.sort((function(e,t){var n=+r.getAdvOption({options:e.options},"note-priority",1)||0;return(+r.getAdvOption({options:t.options},"note-priority",1)||0)-n})),(n=n.filter((function(e){if(A(e)){if(!e.hidden){var n=e.position;if(n==t.POS.EMBEDDED&&(n=e.placement),T.includes(n)){if(e.onClick)return p({msgs:["Position of campaign ",e.campaignId," is taken, as it has an onClick trigger, we will remove the teaser"],styles:["normal","normal-bold","normal"]}),l.deleteTeaserIf(e),e.exit=!1,e.wait=0,e.scroll=0,e;if(!(e.exit&&O<0))return void p({msgs:["Position of campaign ",e.campaignId," is taken so it won't show"],styles:["normal","normal-bold","normal"]});O=n,l.deleteTeaserIf(e),e.wait=0,e.scroll=0,p({msgs:["Position of campaign ",e.campaignId," is taken, as it has an exit trigger, we will remove the teaser"],styles:["normal","normal-bold","normal"]})}else if(e.exit&&O<0&&(O=n,!l.teaserExist(e)))return e;T.push(n)}return e}}))).sort((function(e,t){function n(n){return e[n]&&t[n]?e[n]-t[n]:t[n]?1:e[n]?-1:void 0}var s;return void 0!==(s=n("scroll"))||void 0!==(s=n("wait"))||void 0!==(s=n("exit"))?s:0}))),n}function U(e){for(var t=e.length;t--;)H(e[t])}var B,V,_,G;async function H(s){let i,o,a=r.extend(s),l=k(a);return l in C?(i=await C[l],["wait","onClick"].forEach((function(e){i.config[e]=a[e]}))):C[l]=new c.Promise((async function(s,r){if(await d.arequire("package-notes"),o=a.position==t.POS.EMBEDDED,o?({EmbeddedCampaign:B,layout:G}=await d.arequire("package-embedded")):({AnchoredCampaign:V,orchestrator:_,layout:G}=await d.arequire("package-anchored")),G.viewport||G.initialize(),i=o?await B.create({config:a}):await V.create({config:a}),i&&!e.editor&&!o){if(a.exit&&Y(),a.scroll&&$(),i.teaserExist&&!i.config.hidden&&i.canBeLaunched()&&i.config.wait>=0){let e=i.first("teaser");n(f.QUEUE,{creator:h,name:e,origin:i.notes[e],trigger:"none"})}i.launchTriggers(((e,t)=>{if(("timer"==e||"notification"==e)&&t.canBeLaunched()){let e=t.first("form");n(f.QUEUE,{creator:h,name:e,origin:t.notes[e],trigger:"timer"})}}))}return i?(n(t.CORE.EVENTS.READY,i),w[l]=i,s(i)):(m&&console.log("failed to add",a),r(a))})),C[l]}function Y(){s.is.desktop&&(r.listener(g.documentElement,"add",(function(e){if(!e.relatedTarget&&e.clientY<10)for(let e of Object.values(C))e.then((function(e){if(e.ifTrigger("exit")&&e.canBeLaunched()){let t=e.first("form");n(f.OPEN,{creator:h,name:t,origin:e.notes[t],trigger:"exit"})}}))}),!0)("mouseout"),Y=()=>{})}function $(){var e,t=function(){y=0;for(let e of Object.values(C))e.then((function(e){if(e.ifTrigger("scroll")&&e.canBeLaunched()){let t=e.first("form");n(f.OPEN,{creator:h,name:t,origin:e.notes[t],trigger:"scroll"})}}))};r.listener(d,"add",(function(n){var s=+new Date;y&&s-y<1e3||(c.clearTimeout(e),e=c.setTimeout(t,2e3),y=s)}),!0)("scroll"),$=()=>{}}function j(e=!0){return{result:e,handled:!0}}g.addEventListener(e.eventName,(function(e){e.data.type==t.CORE.EVENTS.SITEDATA&&N(e.data.type,(function(e){e.triggerOnSiteDataIf()}))}));let F={destructivelyChangeCampaign:function(e,t){let n=M(e,I),s=w[e];if(n<0||!s)return;let r=I[n];return s.destroy(!0),delete C[e],delete w[e],r=t(r,s),H(r)},status:function(){let e={campaigns:{},visible:{}};for(let[t,n]of r.entries(w)){let s=r.extend(n.config);delete s.steps,s.notes=Object.keys(n.notes).map((e=>n.notes[e].config)),e.campaigns[t]=s,"EmbeddedCampaign"==n.kind&&n.visibleNote.noteName&&(e.visible[t]={campaignId:t,name:n.visibleNote.noteName,kind:"EmbeddedCampaign"})}if(_)for(let[t,n]of r.entries(_.visibles))e.visible[t]={campaignId:t,name:n.noteName};return e},API:function({command:e,noteName:n,keep:s,config:r,campaign:o,onlyShowPreloaded:a,campaignId:c,ignoreRules:u,excludeConditions:d}){m&&console.log("Launcher API call:",e,c,n,s,r,o,a,u,d);const g=t.CORE.API;switch(e){case g.LAUNCH:return j(async function(e,t){if(t&&i.isSessionClosed(e))return void console.warn("can not show toggler onlyShowPreloaded:"+t+" id:",e);let n=C[e];if(!n&&!t&&(n=D(e),!n))return void console.warn("campaign ",e," failed to load");let s=await n;if(s)return s.config.smartIndex=0,s.tameTeaser(),s;console.warn("campaign ",e," failed to load")}(c,a).then((function(e){if(e){if(n||(n=e.first("form")),e.notes[n])return e.API({command:"open",noteName:n}).result;"outofstock"!=e.config.type&&p({msgs:[`noteName ${n} does not exist in ${c}`],styles:["error"]})}})));case g.EVALUATE:return j(l.evaluate(r,u,d));case g.ADD:return j(L(r));case g.ORCHESTRATOR:return j(_);case g.PROFILE:return j(function(e){return l.getProfile(e)}(r));case g.BUSY:for(let e of Object.values(w))if(e.busy)return j(!0);return j(!1);case g.VISIBLE:return o?o.API({command:e}):j({})}return{handled:!1}},forceLoad:D,add:L,remove:R,createCampaign:H,prioritize:x,preprocessor:a,get rawConfigs(){return v},get includedConfig(){return I},get campaigns(){return C},get campaignsResolved(){return w},get justAdded(){return S},onEvaluate:N};return e.expose(F,"launcher"),F})),sndefine("core-api",["launcher","core-sleeknote","utils","constants","global","storage-instance"],(function(e,t,n,s,r,i){const o=s.CORE.API;let a=0,l=new this.Set,c={};function u(e,t){return a&&console.log("API result for "+t+":",e),e}function d(t,s){let r=[],i=o.CLOSE,a=e.status().visible;for(let o of n.values(a)){let n=e.campaignsResolved[o.campaignId];if(n&&t&&t.config.campaignId!=o.campaignId)continue;let a=n.API({command:i,ffwd:s,noteName:o.name});a.handled&&r.push(a.result)}return n.allSettled(r).then((function(){return t?[t]:Object.values(a)}))}function g(...m){let p,h,f,y,E,S,v,I,C,w,T,O,b,A,N=m[0],P=m[1],R=e.campaignsResolved[P];switch(N){case o.POSITION:f=m[2],//!!!
C=m[3],S=m[4];break;case o.BLINK:p=m[2],S=m[3];break;case o.CLOSEALL:I=m[1];for(let e of l)e.ffwd();return r.Promise.all(Object.keys(e.status().visible).map((e=>g("close",e,I))));case o.STATUS:return u(e.status(),N);case o.CAMPAIGNS:return u(e.campaigns,N);case o.RESET:E=m[1];break;case o.REMOVE:y=m[2],v=m[3];break;case o.CLOSE:I=m[2];break;case o.OPEN:case o.REVEAL:case o.MAXIMIZE:case o.MINIMIZE:case o.QUEUE:case o.NOTE_CONFIG:p=m[2];break;case o.AFTERRENDER:S=m[2];break;case o.NOTE_RERENDER:S=m[3],p=m[2];break;case o.APPLY_CONFIG:p=m[2],h=m[3];break;case o.ADD:case o.PROFILE:h=m[1];break;case o.MERGE:h=m[1],w=m[2];break;case o.HOOK:T=m[1],S=m[2];break;case o.LAUNCH:O=m[2],p=m[3];break;case o.EVALUATE:h=m[1],b=m[2],A=m[3]}return function({command:l,campaignId:m,noteName:p,config:h,position:f,complete:y,keep:E,callback:S,abrupt:v,ffwd:I,placement:C,mergeId:w,hookName:T,onlyShowPreloaded:O,ignoreRules:b,excludeConditions:A}){let N={handled:!1},P=e.campaignsResolved[m];switch(l){case o.WAIT:return new r.Promise((t=>{let n=()=>{e.API({command:o.BUSY}).result?r.setTimeout(n,100):t()};n()}));case o.BUSY:N=e.API({command:l});break;case o.LAUNCH:N=e.API({command:l,campaignId:m,onlyShowPreloaded:O,noteName:p});break;case o.EVALUATE:N=e.API({command:l,config:h,ignoreRules:b,excludeConditions:A});break;case o.VISIBLE:N=e.API({command:l,campaign:P});break;case o.ADD:case o.PROFILE:N=e.API({command:l,config:h});break;case o.ORCHESTRATOR:N=e.API({command:l});break;case o.REMOVE:P&&(e.remove(m),N=P.API({command:l,abrupt:v,complete:y}));break;case o.CLOSE:N={result:d(P,I),handled:!0};break;case o.AFTERRENDER:P&&(N=P.API({command:l,callback:S}));break;case o.POSITION:if(P){let t=f==s.POS.EMBEDDED;if(t&&!C)break;if(P.config.position==f){a&&console.log("position is already set"),N={result:r.Promise.resolve(),handled:!0};break}let n=e.destructivelyChangeCampaign(m,(function(e){e.position=f;for(let n of Object.keys(e.steps))e.steps[n].position=f,t&&(e.steps[n].placement=C);return t&&(e.placement=C),S&&(e=S(e)),e}));N={result:n,handled:!0}}break;case o.MAXIMIZE:case o.MINIMIZE:case o.OPEN:case o.REVEAL:case o.QUEUE:if(P){if(n.contains(l,o.OPEN,o.REVEAL)&&t.editor)for(let t of Object.values(e.status().visible))t.campaignId!=m&&("EmbeddedCampaign"!=t.kind&&"EmbeddedCampaign"!=P.kind||g("close",t.campaignId));N=P.API({command:l,noteName:p})}break;case o.NOTE_RERENDER:P&&(N=P.API({command:l,noteName:p,callback:S}));break;case o.NOTE_CONFIG:P&&(N=P.API({command:l,noteName:p}));break;case o.APPLY_CONFIG:P&&(N=P.API({command:l,noteName:p,config:h}));break;case o.MERGE:let c=h.multimerge;if(h.multimergeCurrent=[],c&&"DateMultiMerge"==c.type){let e;e=Array.isArray(w)?c.rows.find((e=>e[c.id].join()==w.join())):c.rows[w],e&&(h.multimergeCurrent=Array.from(e),i.setMergeId(h.campaignId,w))}N={handled:!0,result:h.multimergeCurrent};break;case o.HOOK:t.hooks[T]=S,N.handled=!0;break;default:console.warn("Unknown API command:",l)}if(N.handled){let e=u(N.result,l);return N.result instanceof r.Promise&&a&&console.log("API result for "+l+" handled",N.result),a&&console.log("API result for "+l+" handled",N.result),e}a&&console.log("API result for "+l+" not handled");if(n.contains(l,o.MAXIMIZE,o.MINIMIZE,o.OPEN,o.REVEAL,o.QUEUE,o.CLOSE))return l!=o.CLOSE&&(t.editor&&(c={}),c[m]={campaignId:m,noteName:p,command:l}),a&&console.log("API result for "+l+" resolve returned"),r.Promise.resolve()}({campaign:R,command:N,campaignId:P,noteName:p,config:h,position:f,complete:y,keep:E,callback:S,abrupt:v,ffwd:I,placement:C,mergeId:w,hookName:T,onlyShowPreloaded:O,ignoreRules:b,excludeConditions:A})}return this.document.addEventListener(t.eventName,(function(e){if(e.type==t.eventName){let{type:t,animator:n,status:r,campaignId:i}=e.data;if(t==s.CORE.EVENTS.ANIMATING)l[r?"add":"delete"](n);else if(t==s.CORE.EVENTS.READY&&i in c){let{command:t,noteName:n}=c[i];delete c[i],n in e.data.boxes&&g(t,i,n)}}})),g})),sndefine("package-core-boot",["launcher","core-sleeknote","event-emitter","core-api","constants","storage-instance","browser","site-data"],(function(e,t,n,s,r,i,o,a){return{launcher:e,coreConfig:t,emit:n,API:s,CONST:r,storage:i,B:o,siteData:a}}));